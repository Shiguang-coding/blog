<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>【尚硅谷】Docker快速通关 | 時光</title><meta name="keywords" content="Docker,尚硅谷"><meta name="author" content="時光"><meta name="copyright" content="時光"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="【尚硅谷】Docker快速通关"><meta name="application-name" content="【尚硅谷】Docker快速通关"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="【尚硅谷】Docker快速通关"><meta property="og:url" content="https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/index.html"><meta property="og:site_name" content="時光"><meta property="og:description" content="在线视频：尚硅谷3小时速通Docker教程，雷神带练docker部署到实战！课程资料: 尚硅谷2024新版3小时速通Docker教程雷神笔记：Docker - 快速通关 （3h） 代码仓库Gitee: https:&amp;#x2F;&amp;#x2F;gitee.com&amp;#x2F;an_shiguang&amp;#x2F;learn-dockerGitHub"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://img.shiguangdev.cn/i/2024/08/28/66cedaf5d014a.jpeg"><meta property="article:author" content="時光"><meta property="article:tag" content="博客,時光,時光的博客,時光博客园子,实用博客,开源,共享"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.shiguangdev.cn/i/2024/08/28/66cedaf5d014a.jpeg"><meta name="description" content="在线视频：尚硅谷3小时速通Docker教程，雷神带练docker部署到实战！课程资料: 尚硅谷2024新版3小时速通Docker教程雷神笔记：Docker - 快速通关 （3h） 代码仓库Gitee: https:&amp;#x2F;&amp;#x2F;gitee.com&amp;#x2F;an_shiguang&amp;#x2F;learn-dockerGitHub"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/"><link rel="preconnect" href="//cdn.cbd.int"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与各类博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://twikoo.shiguangdev.eu.org',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":4000,"accessToken":"","mailMd5":""},
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"https://fcircle.shiguangdev.cn/"},
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🌟 技术分享领航人","📚 终身学习倡导者","💡 创新思维启发源","📈 成长路径引路人","🚀 科技趋势探索者","🤖️ AI技术探索先锋","🌈 技术创新推动手","💬 社区互动活跃家","🛠️ 代码经验传授师","📢 知识传播倡导员"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":300,"languages":{"author":"作者: 時光","link":"链接: ","source":"来源: 時光","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '時光',
  title: '【尚硅谷】Docker快速通关',
  postAI: '',
  pageFillDescription: 'Docker介绍, Docker优势, 一致的环境, 隔离性, 可移植性, 快速部署和扩展, 版本控制和依赖管理, 资源效率, 社区和生态系统, 简化开发流程, Docker组件, Docker CLI (命令行接口), Docker Host (Docker 守护进程), 容器 (Container), 镜像 (Image), 仓库 (Registry), 关系总结, 应用程序部署方式, 传统部署 (Traditional Deployment), 虚拟化部署 (Virtualization Deployment), 容器部署 (Container Deployment), 总结, 安装Docker, 移除旧版本, Ubuntux2FDebian, 卸载 Docker Engine, 卸载 Docker Compose（如果安装了）, CentOSx2FRHEL, 卸载 Docker Engine, 卸载 Docker Compose（如果安装了）, Windows, 卸载 Docker Desktop, macOS, 卸载 Docker Desktop, 总结, 安装x2F更新最新版本, Docker命令, Docker存储, 目录挂载, 卷映射, Docker网络, 实战练习, Redis主从同步集群, 启动MySQL, Docker compose, 常用命令, docker-compose up, docker-compose down, docker-compose ps, docker-compose logs, docker-compose build, docker-compose exec, docker-compose start, docker-compose stop, docker-compose restart, docker-compose pull, docker-compose config, docker-compose run, docker-compose scale, docker-compose port, docker-compose top, 总结, 使用Docker compose启动wordpress, --restart 的作用, compose.yaml, 特性, 增量更新, 数据不删, Dockerfile, 通过Dockerfile构建 镜像, 镜像分层存储机制, 分层存储的概念, 分层存储的实现, 镜像层, 容器层, 分层存储的示例, 附录：一键安装超多中间件, yaml, 启动, 访问在线视频尚硅谷小时速通教程雷神带练部署到实战课程资料尚硅谷新版小时速通教程雷神笔记快速通关代码仓库介绍官网是一个开源的容器化平台它允许开发者将应用程序及其依赖项打包到一个轻量级的可移植的容器中优势一致的环境开发与生产环境一致性确保应用程序在开发测试和生产环境中运行一致无论在哪个环境中应用程序的行为都是相同的因为所有的依赖项和配置都打包在容器中避免在我的机器上可以运行的问题由于环境一致性开发者可以避免因环境差异导致的运行问题隔离性资源隔离每个容器都是独立的它们之间相互隔离不会相互干扰这意味着你可以运行多个容器每个容器都可以有自己的依赖项和配置而不会影响其他容器安全性由于隔离性容器内的应用程序不会直接访问宿主机的资源从而提高了安全性可移植性跨平台运行容器可以在任何支持的平台上运行无论是还是这使得应用程序可以在不同的环境中轻松部署云平台支持大多数云服务提供商都支持使得应用程序可以轻松地在不同的云环境中迁移和扩展快速部署和扩展快速启动容器启动速度非常快通常只需几秒钟这使得开发者在开发和测试过程中可以快速启动和停止容器水平扩展容器可以轻松地进行水平扩展通过启动多个容器实例来处理更多的请求版本控制和依赖管理版本控制镜像可以进行版本控制开发者可以轻松地回滚到之前的版本或者在不同的版本之间切换依赖管理镜像包含了应用程序的所有依赖项确保在不同的环境中运行时不会缺少任何依赖资源效率轻量级容器比虚拟机更轻量级因为它们共享宿主机的操作系统内核而不是每个容器都运行一个完整的操作系统资源利用率高由于轻量级和高效的资源管理容器可以更高效地利用系统资源社区和生态系统丰富的镜像库提供了大量的公共镜像开发者可以直接使用这些镜像来快速构建应用程序强大的生态系统有庞大的社区支持和丰富的工具链如等可以帮助开发者更高效地管理和部署容器化应用简化开发流程简化开发环境配置开发者可以使用来定义开发环境确保所有团队成员使用相同的环境进行开发简化测试流程测试人员可以使用容器来运行测试确保测试环境与生产环境一致组件在生态系统中各个组件之间有着紧密的联系共同协作以实现容器化应用的构建分发和运行以下是中各个关键组件之间的关系命令行接口定义是用户与交互的主要工具它提供了一组命令允许用户管理镜像容器网络和存储等资源作用用户通过发送命令这些命令会被发送到守护进程进行处理示例命令等守护进程定义是运行守护进程的机器守护进程负责管理对象如容器镜像网络和卷等作用接收来自的命令并执行相应的操作它还负责与注册表仓库进行通信以拉取或推送镜像关系是和容器之间的桥梁容器定义容器是中的运行实例它是基于镜像创建的容器包含了应用程序及其所有依赖项并且与宿主机和其他容器隔离作用容器提供了一个轻量级的可移植的运行环境使得应用程序可以在任何支持的环境中运行关系容器是基于镜像创建的并且由管理容器可以被启动停止删除和迁移镜像定义镜像是用于创建容器的只读模板它包含了运行应用程序所需的所有文件库配置和依赖项作用镜像是容器的构建块它定义了容器的行为和环境镜像可以通过构建也可以从仓库中拉取关系镜像是容器的蓝图容器是镜像的运行实例镜像可以被推送到仓库也可以从仓库中拉取仓库定义仓库是存储和分发镜像的地方是最常用的公共仓库但也可以使用私有仓库作用仓库允许用户共享和分发镜像使得团队成员可以轻松获取和使用相同的镜像关系可以从仓库中拉取镜像也可以将本地构建的镜像推送到仓库提供了和命令来与仓库交互关系总结是用户与交互的接口用户通过它发送命令是运行守护进程的机器负责处理的命令并管理容器和镜像容器是基于镜像创建的运行实例由管理镜像是容器的只读模板定义了容器的行为和环境仓库是存储和分发镜像的地方可以从仓库中拉取镜像也可以将本地镜像推送到仓库通过这些组件的协作提供了一个完整的容器化解决方案使得应用程序的构建分发和运行变得更加简单和高效应用程序部署方式传统部署虚拟化部署和容器部署是三种不同的应用程序部署方式它们在资源利用隔离性可移植性和管理复杂性等方面有着显著的区别以下是它们的详细比较传统部署特点直接在物理服务器上运行应用程序直接安装在物理服务器上使用服务器的操作系统及其资源资源共享有限多个应用程序通常不能在同一台物理服务器上运行因为它们可能会相互干扰环境依赖性强应用程序对操作系统和服务器环境的依赖性强环境差异可能导致应用程序无法正常运行扩展性差扩展应用程序通常需要增加物理服务器成本高且管理复杂优点简单直接部署过程相对简单不需要额外的虚拟化或容器化技术性能高直接在物理硬件上运行性能通常较高缺点资源利用率低物理服务器的资源利用率通常较低因为多个应用程序不能共享同一台服务器环境一致性差开发测试和生产环境可能存在差异导致在我的机器上可以运行的问题扩展性差扩展应用程序需要增加物理服务器成本高且管理复杂虚拟化部署特点在虚拟机上运行应用程序运行在虚拟机中每个虚拟机都有自己的操作系统资源隔离每个虚拟机相互隔离不会相互干扰提高了安全性资源共享多个虚拟机可以运行在同一台物理服务器上提高了资源利用率可移植性虚拟机可以在不同的物理服务器之间迁移提高了可移植性优点资源利用率高多个虚拟机可以共享同一台物理服务器的资源提高了资源利用率隔离性好每个虚拟机相互隔离提高了安全性可移植性好虚拟机可以在不同的物理服务器之间迁移提高了可移植性缺点性能开销虚拟机需要运行完整的操作系统性能开销较大启动时间长虚拟机启动时间较长通常需要几分钟管理复杂虚拟机的管理和维护相对复杂需要专门的虚拟化管理工具容器部署特点在容器中运行应用程序运行在容器中容器共享宿主机的操作系统内核轻量级容器比虚拟机更轻量级因为它们不需要运行完整的操作系统资源隔离容器之间相互隔离不会相互干扰提高了安全性快速启动容器启动速度非常快通常只需几秒钟可移植性容器可以在任何支持的环境中运行提高了可移植性优点轻量级容器比虚拟机更轻量级资源利用率高快速启动容器启动速度非常快通常只需几秒钟可移植性好容器可以在任何支持的环境中运行提高了可移植性环境一致性好开发测试和生产环境一致避免了在我的机器上可以运行的问题缺点隔离性相对较弱虽然容器之间相互隔离但隔离性不如虚拟机强依赖宿主机内核容器依赖宿主机的操作系统内核因此在不同操作系统上运行可能会有兼容性问题总结特性传统部署虚拟化部署容器部署资源利用率低高高隔离性差好较好可移植性差好好启动时间快慢快性能开销低高低环境一致性差较好好扩展性差好好管理复杂性低高中通过以上比较可以看出容器部署在资源利用率启动时间可移植性和环境一致性等方面具有显著优势但在隔离性和对宿主机内核的依赖性方面存在一定的局限性虚拟化部署则在隔离性和资源利用率方面表现较好但性能开销和管理复杂性较高传统部署则相对简单直接但在资源利用率和环境一致性方面存在明显不足安装可以使用虚拟机或者购买计费云服务器国内常见云平台阿里云腾讯云华为云青云使用下载移除旧版本卸载的过程取决于你使用的操作系统和安装方式以下是几种常见操作系统的卸载步骤移除旧版本卸载卸载包删除数据删除配置文件可选删除用户组可选卸载如果安装了卸载卸载卸载包删除数据删除配置文件可选删除用户组可选卸载如果安装了卸载卸载打开控制面板点击开始菜单搜索并打开控制面板卸载程序在控制面板中选择程序程序和功能找到右键点击并选择卸载删除数据可选打开文件资源管理器导航到目录删除其中的内容卸载打开应用程序文件夹在中导航到应用程序文件夹删除找到应用程序将其拖到废纸篓中清空废纸篓右键点击废纸篓图标选择清空废纸篓删除数据可选打开终端运行以下命令删除数据总结卸载的过程主要包括卸载包删除数据和配置文件根据操作系统的不同卸载步骤略有差异确保在卸载前备份重要数据以免丢失安装更新最新版本官网完整手册配置源安装最新启动开机启动二合一配置加速配置镜像站安装包及镜像站输入下列内容最后按输入保存退出当你修改了的配置文件后通常需要重启服务以使更改生效命令启动一个并将它的首页改为自己的页面发布出去让所有人都能使用仓库地址搜索镜像下载镜像下载指定版本镜像下载最新版本镜像查看所有镜像删除指定的镜像查看运行中的容器容器镜像启动命令启动时间启动状态已启动已停止端口容器名称随机命名查看所有容器查看所有容器运行一个新容器使用时若不指定版本默认为最新版本若本地没有最新版本则自动拉取启动容器后命令窗口不可关闭否则服务停止启动容器根据容器可以用容器的前几位能够和其他容器区分即可可以根据容器名停止容器可以根据容器可以用容器的前几位能够和其他容器区分即可可以根据容器名重启容器同上可使用容器容器前缀容器名称无论是否已启动均可使用查看容器资源占用情况同上可使用容器容器前缀容器名称查看容器日志同上可使用容器容器前缀容器名称删除指定容器同上可使用容器容器前缀容器名称删除的前提时并未使用若在使用中可使用强制删除强制删除查询到的容器后台启动容器后台启动时可以给容器指定命名否则会随机命名后台启动并暴露端口端口映射外部端口内部端口将内部的端口映射到外部的端口上因为容器之间是相互隔离的多个容器之间内部端口可以重复外部端口对应当前主机的端口不可重复进入容器内部使用退出交互模式也可直接写作例如修改首页内容切换到提交容器变化打成一个新的镜像打包的镜像名必须小写新镜像创建成功后可使用查看保存镜像为指定文件删除多个镜像加载镜像登录使用用户名或者邮箱进行登录重新给镜像打标签当前目录文件名推送到远程路径仓库名可以再提交一个最新版本的镜像不然拉取时不指定版本号会出错推送镜像存储目录挂载在中目录挂载是将宿主机的目录直接挂载到容器内的某个路径容器是临时的容器被删除后容器内的数据也会随之丢失通过目录挂载可以将数据存储在宿主机上即使容器被删除数据仍然保留将宿主机的目录挂载到容器内的目录容器内的数据会持久化到宿主机的目录中例如我将容器的资源目录挂载到宿主机指定目录做了目录挂载之后以挂载的宿主机目录为准所需的文件需要自行创建卷映射区分目录挂载和卷映射可通过挂载的路径中是否包含或者来判断在中卷映射是将管理的卷挂载到容器内的某个路径会自动创建一个存储位置即使在容器初始启动的时候就和容器内部的文件保持完全一致映射后的配置文件会保持同步即修改了宿主机映射的配置文件后容器内部的配置文件也会同步修改即使删除容器卷内的数据仍会保存下来例如要映射配置文件启动时可以使用命令映射的文件统一放在目录下命令查看所有卷创建一个卷查看卷信息网络为每个容器分配了唯一使容器端口可以互相访问不过这个由于各种原因可能会变化每个应用启动的时候都会加入一个的默认网络可以查到相关信息也可以使用查看容器细节内容可在配置项中找到网关和地址为了形成稳定访问的网络提供了自定义网络机制默认是不支持使用主机域名访问需要创建一个自定义网络让启动的容器加入到自定义网络容器的名称便可以作为一个稳定的域名创建一个自定义网络查看所有网络容器启动时使用指定自定义网络使用自定义网络作为域名进行访问需使用内部端口实战练习主从同步集群此处使用非官方镜像预设好了很多环境变量配置相对简单镜像仓库地址使用配置环境变量例如此处使用下列命令自定义网络主节点此时并未处于运行状态因为映射的文件没有操作权限给目录授予权限重启实例用于映射目录给映射目录赋予操作权限从节点启动成功后可在使用官方需要订阅百度网盘连接两个服务往主节点添加一个刷新从节点已自动同步主节点数据启动是一个用于定义和运行多容器应用程序的工具通过使用文件来配置应用程序的服务网络和卷可以轻松地启动停止和管理多个容器常用命令提供了许多命令来管理多容器应用程序以下是一些常用的命令及其用法功能启动服务常用选项在后台运行服务在启动服务之前构建镜像强制重新创建容器即使它们的配置和镜像没有改变示例功能停止并删除服务常用选项删除与服务关联的卷删除所有与服务关联的镜像示例功能列出正在运行的服务示例功能查看服务的日志常用选项实时跟踪日志输出只显示最后行日志示例功能构建服务镜像常用选项不使用缓存构建镜像示例功能在运行的容器中执行命令常用选项禁用分配指定用户示例功能启动已停止的服务示例功能停止正在运行的服务示例功能重启服务示例功能拉取服务的镜像示例功能验证并查看文件的配置示例功能运行一次性命令常用选项设置环境变量命令完成后删除容器示例功能扩展服务的实例数量示例功能查看服务的端口映射示例功能查看正在运行的进程示例总结提供了丰富的命令来管理多容器应用程序通过这些命令可以轻松地启动停止重启构建查看日志和管理容器合理使用这些命令可以大大简化开发和部署流程使用启动命令中的选项用于指定容器在退出时守护进程应如何处理容器的重启策略这个选项非常有用特别是在生产环境中确保容器在意外退出时能够自动重启从而提高服务的可用性的作用选项允许你定义容器的重启策略主要有以下几种策略默认策略容器退出时不会自动重启只有在容器非正常退出即退出状态码不为时才会自动重启无论容器以何种状态退出都会自动重启与类似但当容器被手动停止使用或后即使守护进程重启容器也不会自动启动创建网络启动启动官方文档切换到文件目录执行启动启动时也可用指定文件文件名特性增量更新修改文件重新启动应用只会触发修改项的重新启动数据不删默认就算了容器所有挂载的卷不会被移除比较安全如果要删除容器的同时删除所有卷可以使用以下命令官方文档切换到包所在目录通过启动服务可以通过指定启动端口通过构建镜像以下是一个简单的示例文件名称在当前目录下执行其中代表指定版本代表当前目录构建好后即可通过查看镜像分层存储机制的分层存储机制是其核心特性之一它使得镜像的构建共享和部署变得高效且灵活分层存储机制通过将镜像和容器的数据存储在不同的层中实现了镜像的轻量化和快速部署分层存储的概念镜像是由一系列只读层组成的每一层代表镜像构建过程中的一个步骤例如安装软件包添加文件或修改配置这些层是只读的一旦创建就不能修改当容器启动时会在这些只读层之上添加一个可写层用于存储容器运行时的修改分层存储的实现镜像层只读层镜像的每一层都是只读的一旦创建就不能修改每一层都有一个唯一的标识符用于在不同的镜像之间共享层的内容每一层包含了文件系统的变化例如添加删除或修改的文件这些变化以增量方式存储只有发生变化的部分会被存储容器层可写层当容器启动时会在镜像的最上层添加一个可写层容器运行时的所有修改例如创建新文件修改文件删除文件都会存储在这个可写层中临时性容器层的修改是临时的当容器停止或删除时这些修改会丢失如果需要持久化数据可以使用卷或绑定挂载分层存储的示例假设我们有一个简单的在这个中镜像的构建过程可以分为以下几层基础层镜像更新和安装层文件复制层启动命令层每一层都是一个只读层当容器启动时会在这些只读层之上添加一个可写层附录一键安装超多中间件注意将下面文件中的改为你自己的服务器所有容器都做了时间同步这样容器的时间和主机的时间就一致了准备一个文件内容如下启动如果重启了服务器可能有些容器会启动失败再执行一遍即可所有程序都可运行成功并且不会丢失数据请放心使用在文件所在的目录下执行等待启动所有容器访问可视化工具下载可视化工具下载组件容器名介绍访问地址账号密码特性库你的单密码模式已开启数据库你的默认字符集消息队列你的暴露和端口检索引擎你的内存两个节点可视化你的分布式协调你的允许匿名登录消息队列你的外部访问占用内存可视化你的注册配置中心你的持久化数据到配套数据库你的时序数据库你的你的',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-16 10:14:50',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><script async="" defer="" src="https://umami.shiguangdev.cn/script.js" data-website-id="bc279f56-9a19-416a-a035-58c0abed887b"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="時光" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/avatar.png"><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://publish.shiguang666.eu.org/" title="地址发布页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="地址发布页"><span class="back-menu-item-text">地址发布页</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.shiguang666.eu.org" title="時光主页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="時光主页"><span class="back-menu-item-text">時光主页</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://nav.shiguang666.eu.org" title="時光导航站"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://nav.shiguang666.eu.org/images/logo-collapsed@2x.png" alt="時光导航站"><span class="back-menu-item-text">時光导航站</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://lobe.shiguang666.eu.org" title="LobeChat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lobe.shiguang666.eu.org/favicon.ico" alt="LobeChat"><span class="back-menu-item-text">LobeChat</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://chatgpt.shiguang666.eu.org/" title="NextChat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chatgpt.shiguang666.eu.org/favicon.ico" alt="NextChat"><span class="back-menu-item-text">NextChat</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://geminichat.shiguang666.eu.org/" title="GeminiChat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://geminichat.shiguang666.eu.org/icons/logo-512x512.png" alt="GeminiChat"><span class="back-menu-item-text">GeminiChat</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://game.shiguang666.eu.org" title="怀旧游戏机"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="怀旧游戏机"><span class="back-menu-item-text">怀旧游戏机</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://love.shiguang666.eu.org" title="表白生成器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://love.shiguang666.eu.org/favicon.ico" alt="表白生成器"><span class="back-menu-item-text">表白生成器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">后台管理</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://umami.shiguangdev.cn/share/1CY8KW6pqM0UBUIL/blog.shiguangdev.cn" title="访客统计"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://umami.shiguangdev.cn/favicon.ico" alt="访客统计"><span class="back-menu-item-text">访客统计</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://img.shiguangdev.cn/" title="時光图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/favicon.ico" alt="時光图床"><span class="back-menu-item-text">時光图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://qexo.shiguang666.eu.org/" title="Qexo"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png" alt="Qexo"><span class="back-menu-item-text">Qexo</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">時光</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随机</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/news/"><i class="fa fa-calendar faa-tada"></i><span> 早报亭</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=10051718332&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/xjj/"><i class="fa fa-rocket faa-tada"></i><span> 养生堂</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comment/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.png"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.png"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">31</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">38</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">18</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">30</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">20</span><span>篇</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">学习笔记</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Docker/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Docker</span></a><a class="article-meta__tags" href="/tags/%E5%B0%9A%E7%A1%85%E8%B0%B7/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>尚硅谷</span></a></span></div></div><h1 class="post-title" itemprop="name headline">【尚硅谷】Docker快速通关</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-09-18T05:03:55.000Z" title="发表于 2024-09-18 13:03:55">2024-09-18</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-10-16T02:14:50.167Z" title="更新于 2024-10-16 10:14:50">2024-10-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">9.1k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>35分钟</span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为上海"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>上海</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/09/18/847c1ec4d4cd/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://img.shiguangdev.cn/i/2024/08/28/66cedaf5d014a.jpeg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope="" itemtype="https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/"><header><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">学习笔记</a><a href="/tags/Docker/" tabindex="-1" itemprop="url">Docker</a><a href="/tags/%E5%B0%9A%E7%A1%85%E8%B0%B7/" tabindex="-1" itemprop="url">尚硅谷</a><h1 id="CrawlerTitle" itemprop="name headline">【尚硅谷】Docker快速通关</h1><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">時光</span><time itemprop="dateCreated datePublished" datetime="2024-09-18T05:03:55.000Z" title="发表于 2024-09-18 13:03:55">2024-09-18</time><time itemprop="dateCreated datePublished" datetime="2024-10-16T02:14:50.167Z" title="更新于 2024-10-16 10:14:50">2024-10-16</time></header><div id="postchat_postcontent"><blockquote>
<p>在线视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Zn4y1X7AZ">尚硅谷3小时速通Docker教程，雷神带练docker部署到实战！</a><br>课程资料: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1jdN7HjjO6JDNOSGgd3r8pA?pwd=yyds">尚硅谷2024新版3小时速通Docker教程</a><br>雷神笔记：<a target="_blank" rel="noopener" href="https://www.yuque.com/leifengyang/sutong/au0lv3sv3eldsmn8"><strong>Docker - 快速通关 （3h）</strong></a></p>
<p>代码仓库<br>Gitee: <a target="_blank" rel="noopener" href="https://gitee.com/an_shiguang/learn-docker">https://gitee.com/an_shiguang/learn-docker</a><br>GitHub: <a target="_blank" rel="noopener" href="https://github.com/Shiguang-coding/learn-docker">https://github.com/Shiguang-coding/learn-docker</a></p>
</blockquote>
<h1 id="Docker介绍"><a href="#Docker介绍" class="headerlink" title="Docker介绍"></a>Docker介绍</h1><blockquote>
<p>Docker 官网： <a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com/</a></p>
</blockquote>
<p>Docker 是一个开源的容器化平台，它允许开发者将应用程序及其依赖项打包到一个轻量级的、可移植的容器中。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66ea65694d27b.png" alt="image-20240918133016634"></p>
<h2 id="Docker优势"><a href="#Docker优势" class="headerlink" title="Docker优势"></a>Docker优势</h2><h3 id="一致的环境"><a href="#一致的环境" class="headerlink" title="一致的环境"></a><strong>一致的环境</strong></h3><p><strong>开发与生产环境一致性</strong>：Docker 确保应用程序在开发、测试和生产环境中运行一致。无论在哪个环境中，应用程序的行为都是相同的，因为所有的依赖项和配置都打包在容器中。</p>
<p><strong>避免“在我的机器上可以运行”的问题</strong>：由于环境一致性，开发者可以避免因环境差异导致的运行问题。</p>
<h3 id="隔离性"><a href="#隔离性" class="headerlink" title="隔离性"></a><strong>隔离性</strong></h3><p><strong>资源隔离</strong>：每个 Docker 容器都是独立的，它们之间相互隔离，不会相互干扰。这意味着你可以运行多个容器，每个容器都可以有自己的依赖项和配置，而不会影响其他容器。</p>
<p><strong>安全性</strong>：由于隔离性，容器内的应用程序不会直接访问宿主机的资源，从而提高了安全性。</p>
<h3 id="可移植性"><a href="#可移植性" class="headerlink" title="可移植性"></a><strong>可移植性</strong></h3><p><strong>跨平台运行</strong>：Docker 容器可以在任何支持 Docker 的平台上运行，无论是 Linux、Windows 还是 macOS。这使得应用程序可以在不同的环境中轻松部署。</p>
<p><strong>云平台支持</strong>：大多数云服务提供商都支持 Docker，使得应用程序可以轻松地在不同的云环境中迁移和扩展。</p>
<h3 id="快速部署和扩展"><a href="#快速部署和扩展" class="headerlink" title="快速部署和扩展"></a><strong>快速部署和扩展</strong></h3><p><strong>快速启动</strong>：Docker 容器启动速度非常快，通常只需几秒钟。这使得开发者在开发和测试过程中可以快速启动和停止容器。</p>
<p><strong>水平扩展</strong>：Docker 容器可以轻松地进行水平扩展，通过启动多个容器实例来处理更多的请求。</p>
<h3 id="版本控制和依赖管理"><a href="#版本控制和依赖管理" class="headerlink" title="版本控制和依赖管理"></a><strong>版本控制和依赖管理</strong></h3><p><strong>版本控制</strong>：Docker 镜像可以进行版本控制，开发者可以轻松地回滚到之前的版本，或者在不同的版本之间切换。</p>
<p><strong>依赖管理</strong>：Docker 镜像包含了应用程序的所有依赖项，确保在不同的环境中运行时不会缺少任何依赖。</p>
<h3 id="资源效率"><a href="#资源效率" class="headerlink" title="资源效率"></a><strong>资源效率</strong></h3><p><strong>轻量级</strong>：Docker 容器比虚拟机更轻量级，因为它们共享宿主机的操作系统内核，而不是每个容器都运行一个完整的操作系统。</p>
<p><strong>资源利用率高</strong>：由于轻量级和高效的资源管理，Docker 容器可以更高效地利用系统资源。</p>
<h3 id="社区和生态系统"><a href="#社区和生态系统" class="headerlink" title="社区和生态系统"></a><strong>社区和生态系统</strong></h3><p><strong>丰富的镜像库</strong>：Docker Hub 提供了大量的公共镜像，开发者可以直接使用这些镜像来快速构建应用程序。</p>
<p><strong>强大的生态系统</strong>：Docker 有庞大的社区支持和丰富的工具链，如 Kubernetes、Docker Compose 等，可以帮助开发者更高效地管理和部署容器化应用。</p>
<h3 id="简化开发流程"><a href="#简化开发流程" class="headerlink" title="简化开发流程"></a><strong>简化开发流程</strong></h3><p><strong>简化开发环境配置</strong>：开发者可以使用 Docker 来定义开发环境，确保所有团队成员使用相同的环境进行开发。</p>
<p><strong>简化测试流程</strong>：测试人员可以使用 Docker 容器来运行测试，确保测试环境与生产环境一致。</p>
<h2 id="Docker组件"><a href="#Docker组件" class="headerlink" title="Docker组件"></a>Docker组件</h2><p>在 Docker 生态系统中，各个组件之间有着紧密的联系，共同协作以实现容器化应用的构建、分发和运行。以下是 Docker 中各个关键组件之间的关系：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66ea675317ff5.png" alt="image-20240918133826493"></p>
<h3 id="Docker-CLI-命令行接口"><a href="#Docker-CLI-命令行接口" class="headerlink" title="Docker CLI (命令行接口)"></a><strong>Docker CLI (命令行接口)</strong></h3><p><strong>定义</strong>：Docker CLI 是用户与 Docker 交互的主要工具。它提供了一组命令，允许用户管理 Docker 镜像、容器、网络和存储等资源。</p>
<p><strong>作用</strong>：用户通过 Docker CLI 发送命令，这些命令会被发送到 Docker 守护进程（Docker Host）进行处理。</p>
<p><strong>示例命令</strong>：<code>docker run</code>, <code>docker build</code>, <code>docker pull</code>, <code>docker push</code> 等。</p>
<h3 id="Docker-Host-Docker-守护进程"><a href="#Docker-Host-Docker-守护进程" class="headerlink" title="Docker Host (Docker 守护进程)"></a><strong>Docker Host (Docker 守护进程)</strong></h3><p><strong>定义</strong>：Docker Host 是运行 Docker 守护进程（<code>dockerd</code>）的机器。守护进程负责管理 Docker 对象，如容器、镜像、网络和卷等。</p>
<p><strong>作用</strong>：Docker Host 接收来自 Docker CLI 的命令，并执行相应的操作。它还负责与 Docker 注册表（仓库）进行通信，以拉取或推送镜像。</p>
<p><strong>关系</strong>：Docker Host 是 Docker CLI 和 Docker 容器之间的桥梁。</p>
<h3 id="容器-Container"><a href="#容器-Container" class="headerlink" title="容器 (Container)"></a><strong>容器 (Container)</strong></h3><p><strong>定义</strong>：容器是 Docker 中的运行实例，它是基于镜像创建的。容器包含了应用程序及其所有依赖项，并且与宿主机和其他容器隔离。</p>
<p><strong>作用</strong>：容器提供了一个轻量级的、可移植的运行环境，使得应用程序可以在任何支持 Docker 的环境中运行。</p>
<p><strong>关系</strong>：容器是基于镜像创建的，并且由 Docker Host 管理。容器可以被启动、停止、删除和迁移。</p>
<h3 id="镜像-Image"><a href="#镜像-Image" class="headerlink" title="镜像 (Image)"></a><strong>镜像 (Image)</strong></h3><p><strong>定义</strong>：镜像是用于创建容器的只读模板。它包含了运行应用程序所需的所有文件、库、配置和依赖项。</p>
<p><strong>作用</strong>：镜像是容器的构建块，它定义了容器的行为和环境。镜像可以通过 Dockerfile 构建，也可以从 Docker 仓库中拉取。</p>
<p><strong>关系</strong>：镜像是容器的蓝图，容器是镜像的运行实例。镜像可以被推送到 Docker 仓库，也可以从仓库中拉取。</p>
<h3 id="仓库-Registry"><a href="#仓库-Registry" class="headerlink" title="仓库 (Registry)"></a><strong>仓库 (Registry)</strong></h3><p><strong>定义</strong>：仓库是存储和分发 Docker 镜像的地方。Docker Hub 是最常用的公共仓库，但也可以使用私有仓库。</p>
<p><strong>作用</strong>：仓库允许用户共享和分发镜像，使得团队成员可以轻松获取和使用相同的镜像。</p>
<p><strong>关系</strong>：Docker Host 可以从仓库中拉取镜像，也可以将本地构建的镜像推送到仓库。Docker CLI 提供了 <code>docker pull</code> 和 <code>docker push</code> 命令来与仓库交互。</p>
<h3 id="关系总结"><a href="#关系总结" class="headerlink" title="关系总结"></a>关系总结</h3><ul>
<li><strong>Docker CLI</strong> 是用户与 Docker 交互的接口，用户通过它发送命令。</li>
<li><strong>Docker Host</strong> 是运行 Docker 守护进程的机器，负责处理 Docker CLI 的命令并管理容器和镜像。</li>
<li><strong>容器</strong> 是基于镜像创建的运行实例，由 Docker Host 管理。</li>
<li><strong>镜像</strong> 是容器的只读模板，定义了容器的行为和环境。</li>
<li><strong>仓库</strong> 是存储和分发镜像的地方，Docker Host 可以从仓库中拉取镜像，也可以将本地镜像推送到仓库。</li>
</ul>
<p>通过这些组件的协作，Docker 提供了一个完整的容器化解决方案，使得应用程序的构建、分发和运行变得更加简单和高效。</p>
<h2 id="应用程序部署方式"><a href="#应用程序部署方式" class="headerlink" title="应用程序部署方式"></a>应用程序部署方式</h2><p>传统部署、虚拟化部署和容器部署是三种不同的应用程序部署方式，它们在资源利用、隔离性、可移植性和管理复杂性等方面有着显著的区别。以下是它们的详细比较：</p>
<h3 id="传统部署-Traditional-Deployment"><a href="#传统部署-Traditional-Deployment" class="headerlink" title="传统部署 (Traditional Deployment)"></a><strong>传统部署 (Traditional Deployment)</strong></h3><p><strong>特点</strong>：</p>
<p><strong>直接在物理服务器上运行</strong>：应用程序直接安装在物理服务器上，使用服务器的操作系统及其资源。</p>
<p><strong>资源共享有限</strong>：多个应用程序通常不能在同一台物理服务器上运行，因为它们可能会相互干扰。</p>
<p><strong>环境依赖性强</strong>：应用程序对操作系统和服务器环境的依赖性强，环境差异可能导致应用程序无法正常运行。</p>
<p><strong>扩展性差</strong>：扩展应用程序通常需要增加物理服务器，成本高且管理复杂。</p>
<p><strong>优点</strong>：</p>
<ul>
<li><strong>简单直接</strong>：部署过程相对简单，不需要额外的虚拟化或容器化技术。</li>
<li><strong>性能高</strong>：直接在物理硬件上运行，性能通常较高。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li><strong>资源利用率低</strong>：物理服务器的资源利用率通常较低，因为多个应用程序不能共享同一台服务器。</li>
<li><strong>环境一致性差</strong>：开发、测试和生产环境可能存在差异，导致“在我的机器上可以运行”的问题。</li>
<li><strong>扩展性差</strong>：扩展应用程序需要增加物理服务器，成本高且管理复杂。</li>
</ul>
<h3 id="虚拟化部署-Virtualization-Deployment"><a href="#虚拟化部署-Virtualization-Deployment" class="headerlink" title="虚拟化部署 (Virtualization Deployment)"></a><strong>虚拟化部署 (Virtualization Deployment)</strong></h3><p><strong>特点</strong>：</p>
<ul>
<li><strong>在虚拟机上运行</strong>：应用程序运行在虚拟机（VM）中，每个虚拟机都有自己的操作系统（Guest OS）。</li>
<li><strong>资源隔离</strong>：每个虚拟机相互隔离，不会相互干扰，提高了安全性。</li>
<li><strong>资源共享</strong>：多个虚拟机可以运行在同一台物理服务器上，提高了资源利用率。</li>
<li><strong>可移植性</strong>：虚拟机可以在不同的物理服务器之间迁移，提高了可移植性。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li><strong>资源利用率高</strong>：多个虚拟机可以共享同一台物理服务器的资源，提高了资源利用率。</li>
<li><strong>隔离性好</strong>：每个虚拟机相互隔离，提高了安全性。</li>
<li><strong>可移植性好</strong>：虚拟机可以在不同的物理服务器之间迁移，提高了可移植性。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li><strong>性能开销</strong>：虚拟机需要运行完整的操作系统，性能开销较大。</li>
<li><strong>启动时间长</strong>：虚拟机启动时间较长，通常需要几分钟。</li>
<li><strong>管理复杂</strong>：虚拟机的管理和维护相对复杂，需要专门的虚拟化管理工具。</li>
</ul>
<h3 id="容器部署-Container-Deployment"><a href="#容器部署-Container-Deployment" class="headerlink" title="容器部署 (Container Deployment)"></a><strong>容器部署 (Container Deployment)</strong></h3><p><strong>特点</strong>：</p>
<ul>
<li><strong>在容器中运行</strong>：应用程序运行在容器中，容器共享宿主机的操作系统内核。</li>
<li><strong>轻量级</strong>：容器比虚拟机更轻量级，因为它们不需要运行完整的操作系统。</li>
<li><strong>资源隔离</strong>：容器之间相互隔离，不会相互干扰，提高了安全性。</li>
<li><strong>快速启动</strong>：容器启动速度非常快，通常只需几秒钟。</li>
<li><strong>可移植性</strong>：容器可以在任何支持 Docker 的环境中运行，提高了可移植性。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li><strong>轻量级</strong>：容器比虚拟机更轻量级，资源利用率高。</li>
<li><strong>快速启动</strong>：容器启动速度非常快，通常只需几秒钟。</li>
<li><strong>可移植性好</strong>：容器可以在任何支持 Docker 的环境中运行，提高了可移植性。</li>
<li><strong>环境一致性好</strong>：开发、测试和生产环境一致，避免了“在我的机器上可以运行”的问题。</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li><strong>隔离性相对较弱</strong>：虽然容器之间相互隔离，但隔离性不如虚拟机强。</li>
<li><strong>依赖宿主机内核</strong>：容器依赖宿主机的操作系统内核，因此在不同操作系统上运行可能会有兼容性问题。</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><table>
<thead>
<tr>
<th>特性</th>
<th>传统部署</th>
<th>虚拟化部署</th>
<th>容器部署</th>
</tr>
</thead>
<tbody><tr>
<td>资源利用率</td>
<td>低</td>
<td>高</td>
<td>高</td>
</tr>
<tr>
<td>隔离性</td>
<td>差</td>
<td>好</td>
<td>较好</td>
</tr>
<tr>
<td>可移植性</td>
<td>差</td>
<td>好</td>
<td>好</td>
</tr>
<tr>
<td>启动时间</td>
<td>快</td>
<td>慢</td>
<td>快</td>
</tr>
<tr>
<td>性能开销</td>
<td>低</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>环境一致性</td>
<td>差</td>
<td>较好</td>
<td>好</td>
</tr>
<tr>
<td>扩展性</td>
<td>差</td>
<td>好</td>
<td>好</td>
</tr>
<tr>
<td>管理复杂性</td>
<td>低</td>
<td>高</td>
<td>中</td>
</tr>
</tbody></table>
<p>通过以上比较可以看出，容器部署在资源利用率、启动时间、可移植性和环境一致性等方面具有显著优势，但在隔离性和对宿主机内核的依赖性方面存在一定的局限性。虚拟化部署则在隔离性和资源利用率方面表现较好，但性能开销和管理复杂性较高。传统部署则相对简单直接，但在资源利用率和环境一致性方面存在明显不足。</p>
<h1 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h1><p>可以使用虚拟机或者购买计费云服务器</p>
<blockquote>
<p>国内常见云平台：<br><a target="_blank" rel="noopener" href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=50sid5bu&amp;utm_source=50sid5bu">阿里云</a>、<a target="_blank" rel="noopener" href="https://curl.qcloud.com/iyFTRSJb">腾讯云</a>、<a target="_blank" rel="noopener" href="https://activity.huaweicloud.com/discount_area_v5/index.html?fromacct=d1a6f32e-d6d0-4702-9213-eafe022a0708&amp;utm_source=bGVpZmVuZ3lhbmc==&amp;utm_medium=cps&amp;utm_campaign=201905">华为云</a>、<a target="_blank" rel="noopener" href="https://www.qingcloud.com/">青云</a>……</p>
<p>使用 CentOS 7.9<br>WindTerm下载：<a target="_blank" rel="noopener" href="https://github.com/kingToolbox/WindTerm/releases/download/2.6.0/WindTerm_2.6.1_Windows_Portable_x86_64.zip">https://github.com/kingToolbox/WindTerm/releases/download/2.6.0/WindTerm_2.6.1_Windows_Portable_x86_64.zip</a></p>
</blockquote>
<h2 id="移除旧版本"><a href="#移除旧版本" class="headerlink" title="移除旧版本"></a>移除旧版本</h2><p>卸载 Docker 的过程取决于你使用的操作系统和安装方式。以下是几种常见操作系统的卸载步骤：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS 移除旧版本docker</span></span><br><span class="line"><span class="built_in">sudo</span> yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Ubuntu-Debian"><a href="#Ubuntu-Debian" class="headerlink" title="Ubuntu/Debian"></a><strong>Ubuntu/Debian</strong></h3><h4 id="卸载-Docker-Engine"><a href="#卸载-Docker-Engine" class="headerlink" title="卸载 Docker Engine"></a>卸载 Docker Engine</h4><ol>
<li><p><strong>卸载 Docker 包</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get purge docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>删除 Docker 数据</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /var/lib/docker</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /var/lib/containerd</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>删除 Docker 配置文件</strong>（可选）：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /etc/docker</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>删除 Docker 用户组</strong>（可选）：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> delgroup docker</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h4 id="卸载-Docker-Compose（如果安装了）"><a href="#卸载-Docker-Compose（如果安装了）" class="headerlink" title="卸载 Docker Compose（如果安装了）"></a>卸载 Docker Compose（如果安装了）</h4><ol>
<li><strong>卸载 Docker Compose</strong>：<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> /usr/local/bin/docker-compose</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h3 id="CentOS-RHEL"><a href="#CentOS-RHEL" class="headerlink" title="CentOS/RHEL"></a><strong>CentOS/RHEL</strong></h3><h4 id="卸载-Docker-Engine-1"><a href="#卸载-Docker-Engine-1" class="headerlink" title="卸载 Docker Engine"></a>卸载 Docker Engine</h4><ol>
<li><p><strong>卸载 Docker 包</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> yum remove docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>删除 Docker 数据</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /var/lib/docker</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /var/lib/containerd</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>删除 Docker 配置文件</strong>（可选）：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -rf /etc/docker</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>删除 Docker 用户组</strong>（可选）：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> delgroup docker</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h4 id="卸载-Docker-Compose（如果安装了）-1"><a href="#卸载-Docker-Compose（如果安装了）-1" class="headerlink" title="卸载 Docker Compose（如果安装了）"></a>卸载 Docker Compose（如果安装了）</h4><ol>
<li><strong>卸载 Docker Compose</strong>：<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> /usr/local/bin/docker-compose</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a><strong>Windows</strong></h3><h4 id="卸载-Docker-Desktop"><a href="#卸载-Docker-Desktop" class="headerlink" title="卸载 Docker Desktop"></a>卸载 Docker Desktop</h4><ol>
<li><p><strong>打开“控制面板”</strong>：</p>
<ul>
<li>点击“开始”菜单，搜索并打开“控制面板”。</li>
</ul>
</li>
<li><p><strong>卸载程序</strong>：</p>
<ul>
<li>在“控制面板”中，选择“程序” &gt; “程序和功能”。</li>
<li>找到“Docker Desktop”，右键点击并选择“卸载”。</li>
</ul>
</li>
<li><p><strong>删除 Docker 数据</strong>（可选）：</p>
<ul>
<li>打开文件资源管理器，导航到 <code>C:\ProgramData\DockerDesktop</code> 目录，删除其中的内容。</li>
</ul>
</li>
</ol>
<h3 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a><strong>macOS</strong></h3><h4 id="卸载-Docker-Desktop-1"><a href="#卸载-Docker-Desktop-1" class="headerlink" title="卸载 Docker Desktop"></a>卸载 Docker Desktop</h4><ol>
<li><p><strong>打开“应用程序”文件夹</strong>：</p>
<ul>
<li>在 Finder 中，导航到“应用程序”文件夹。</li>
</ul>
</li>
<li><p><strong>删除 Docker Desktop</strong>：</p>
<ul>
<li>找到“Docker”应用程序，将其拖到“废纸篓”中。</li>
</ul>
</li>
<li><p><strong>清空废纸篓</strong>：</p>
<ul>
<li>右键点击“废纸篓”图标，选择“清空废纸篓”。</li>
</ul>
</li>
<li><p><strong>删除 Docker 数据</strong>（可选）：</p>
<ul>
<li>打开终端，运行以下命令删除 Docker 数据：<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf ~/Library/Containers/com.docker.docker</span><br><span class="line"><span class="built_in">rm</span> -rf ~/Library/Application\ Support/Docker\ Desktop</span><br><span class="line"><span class="built_in">rm</span> -rf ~/Library/Group\ Containers/group.com.docker</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
</li>
</ol>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>卸载 Docker 的过程主要包括卸载 Docker 包、删除 Docker 数据和配置文件。根据操作系统的不同，卸载步骤略有差异。确保在卸载前备份重要数据，以免丢失。</p>
<h2 id="安装-更新最新版本"><a href="#安装-更新最新版本" class="headerlink" title="安装/更新最新版本"></a>安装/更新最新版本</h2><blockquote>
<p>官网完整手册： <a target="_blank" rel="noopener" href="https://docs.docker.com/desktop/install/linux/">https://docs.docker.com/desktop/install/linux/</a></p>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置docker yum源。</span></span><br><span class="line"><span class="built_in">sudo</span> yum install -y yum-utils</span><br><span class="line"><span class="built_in">sudo</span> yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 最新 docker</span></span><br><span class="line"><span class="built_in">sudo</span> yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动&amp; 开机启动docker； enable + start 二合一</span></span><br><span class="line">systemctl <span class="built_in">enable</span> docker --now</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置加速</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /etc/docker</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></span><br><span class="line">{</span><br><span class="line">    <span class="string">"registry-mirrors"</span>: [</span><br><span class="line">        <span class="string">"https://mirror.ccs.tencentyun.com"</span></span><br><span class="line">    ]</span><br><span class="line">}</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br></pre></td></tr></tbody></table></figure>

<p>Linux配置镜像站：</p>
<blockquote>
<p>Docker安装包及镜像站:<a target="_blank" rel="noopener" href="https://github.com/tech-shrimp/docker_installer">https://github.com/tech-shrimp/docker_installer</a></p>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vi /etc/docker/daemon.json</span><br></pre></td></tr></tbody></table></figure>

<p>输入下列内容，最后按ESC，输入 :wq! 保存退出。</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"registry-mirrors"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">"https://docker.1panel.live"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">"https://mirror.ccs.tencentyun.com"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">"https://registry.docker-cn.com"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">"http://hub-mirror.c.163.com"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">"https://docker.m.daocloud.io"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">"https://hub.rat.dev"</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<p>当你修改了 Docker 的 <code>daemon.json</code> 配置文件后，通常需要重启 Docker 服务以使更改生效。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br></pre></td></tr></tbody></table></figure>

<h1 id="Docker命令"><a href="#Docker命令" class="headerlink" title="Docker命令"></a>Docker命令</h1><blockquote>
<p>启动一个nginx,并将它的首页改为自己的页面，发布出去，让所有人都能使用</p>
<p>Docker仓库地址： <a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 搜索镜像</span></span><br><span class="line">docker search nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载镜像</span></span><br><span class="line">docker pull nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载指定版本镜像</span></span><br><span class="line">docker pull nginx:1.26.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载最新版本镜像</span></span><br><span class="line">docker pull nginx:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有镜像</span></span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定id的镜像</span></span><br><span class="line">docker rmi e784f4560448</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看运行中的容器</span></span><br><span class="line"><span class="comment"># CONTAINER ID:容器ID, IMAGE:镜像, COMMAND:启动命令, CREATED:启动时间</span></span><br><span class="line"><span class="comment"># STATUS：启动状态(Up 已启动, Exited 已停止), PORTS:端口, NAMES: 容器名称(随机命名)</span></span><br><span class="line">               </span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有容器</span></span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有容器ID</span></span><br><span class="line">docker ps -aq</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行一个新容器</span></span><br><span class="line"><span class="comment"># 使用docker run 时若不指定版本,默认为最新版本,若本地没有最新版本则自动拉取</span></span><br><span class="line"><span class="comment"># 启动容器后命令窗口不可关闭,否则服务停止</span></span><br><span class="line">docker run nginx</span><br><span class="line"></span><br><span class="line"><span class="comment">### 启动容器 ###</span></span><br><span class="line"><span class="comment"># 根据容器ID </span></span><br><span class="line">docker start 87e68fccff21</span><br><span class="line"><span class="comment"># 可以用容器ID的前几位,能够和其他容器区分即可 </span></span><br><span class="line">docker start 87e</span><br><span class="line"><span class="comment"># 可以根据容器名 NAMES</span></span><br><span class="line">docker start great_noyce</span><br><span class="line"></span><br><span class="line"><span class="comment">### 停止容器 ###</span></span><br><span class="line"><span class="comment"># 可以根据容器ID  </span></span><br><span class="line">docker stop c9cd218ec15b</span><br><span class="line"><span class="comment"># 可以用容器ID的前几位,能够和其他容器区分即可 </span></span><br><span class="line">docker stop c9c</span><br><span class="line"><span class="comment"># 可以根据容器名 NAMES  </span></span><br><span class="line">docker stop sharp_montalcini</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启容器 </span></span><br><span class="line"><span class="comment"># 同上,可使用容器ID,容器ID前缀,容器名称</span></span><br><span class="line"><span class="comment"># 无论是否已启动,均可使用</span></span><br><span class="line">docker restart 592</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器资源占用情况</span></span><br><span class="line"><span class="comment"># 同上,可使用容器ID,容器ID前缀,容器名称</span></span><br><span class="line">docker stats 592</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器日志</span></span><br><span class="line"><span class="comment"># 同上,可使用容器ID,容器ID前缀,容器名称</span></span><br><span class="line">docker logs 592</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定容器</span></span><br><span class="line"><span class="comment"># 同上,可使用容器ID,容器ID前缀,容器名称</span></span><br><span class="line"><span class="comment"># 删除的前提时并未使用</span></span><br><span class="line">docker <span class="built_in">rm</span> 592</span><br><span class="line"><span class="comment"># 若在使用中,可使用 force 强制删除</span></span><br><span class="line">docker <span class="built_in">rm</span> -f 592</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制删除查询到的容器</span></span><br><span class="line">docker <span class="built_in">rm</span> -f $(docker ps -aq)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 后台启动容器</span></span><br><span class="line"><span class="comment"># 后台启动时可以给容器指定命名,否则会随机命名</span></span><br><span class="line">docker run -d --name mynginx nginx</span><br><span class="line"><span class="comment"># 后台启动并暴露端口 </span></span><br><span class="line"><span class="comment"># 端口映射 -p 外部端口：内部端口 88:80 将内部的80端口映射到外部的88端口上</span></span><br><span class="line"><span class="comment"># 因为容器之间是相互隔离的,多个容器之间内部端口可以重复</span></span><br><span class="line"><span class="comment"># 外部端口对应当前主机的端口,不可重复</span></span><br><span class="line">docker run -d --name mynginx -p 80:80 nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入容器内部</span></span><br><span class="line"><span class="comment"># 使用 exit 退出交互模式</span></span><br><span class="line"><span class="comment"># /bin/bash 也可直接写作 bash</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mynginx /bin/bash</span><br><span class="line"><span class="comment"># 例如修改Nginx首页内容,切换到 /usr/share/nginx/html</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&lt;h1&gt;Hello Shiguang Nginx &lt;/h1&gt;"</span> &gt; index.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交容器变化打成一个新的镜像</span></span><br><span class="line"><span class="comment"># 打包的镜像名必须小写</span></span><br><span class="line"><span class="comment"># 新镜像创建成功后 可使用 docker images 查看</span></span><br><span class="line">docker commit -m <span class="string">"update Nginx index.html"</span> myNginx shiguangnginx:v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存镜像为指定文件</span></span><br><span class="line">docker save -o mynginx.tar shiguangnginx:v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除多个镜像</span></span><br><span class="line">docker rmi bde7d154a67f 94543a6c1aef e784f4560448</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载镜像</span></span><br><span class="line">docker load -i mynginx.tar </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录 docker hub</span></span><br><span class="line"><span class="comment"># 使用用户名或者邮箱进行登录</span></span><br><span class="line">docker login</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新给镜像打标签</span></span><br><span class="line"><span class="comment"># tag 当前目录文件名 推送到远程路径仓库名</span></span><br><span class="line">docker tag mynginx:v1.0 leifengyang/mynginx:v1.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以再提交一个最新版本的镜像,不然拉取时不指定版本号会出错</span></span><br><span class="line">docker tag mynginx:v1.0 leifengyang/mynginx:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送镜像</span></span><br><span class="line">docker push leifengyang/mynginx:v1.0</span><br></pre></td></tr></tbody></table></figure>

<h1 id="Docker存储"><a href="#Docker存储" class="headerlink" title="Docker存储"></a>Docker存储</h1><h2 id="目录挂载"><a href="#目录挂载" class="headerlink" title="目录挂载"></a>目录挂载</h2><p>在 Docker 中，目录挂载（Directory Mounting）是将宿主机的目录直接挂载到容器内的某个路径。</p>
<p>Docker 容器是临时的，容器被删除后，容器内的数据也会随之丢失。通过目录挂载，可以将数据存储在宿主机上，即使容器被删除，数据仍然保留。</p>
<p>将宿主机的 <code>/host/data</code> 目录挂载到容器内的 <code>/container/data</code> 目录，容器内的数据会持久化到宿主机的 <code>/host/data</code> 目录中。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /host/data:/container/data my_image</span><br></pre></td></tr></tbody></table></figure>

<p>例如我将Docker容器的Nginx资源目录挂载到宿主机指定目录</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 80:80 --name app -v /home/docker/nginx:/usr/share/nginx/html nginx</span><br></pre></td></tr></tbody></table></figure>

<p>做了目录挂载之后，以挂载的宿主机目录为准，所需的文件需要自行创建</p>
<h2 id="卷映射"><a href="#卷映射" class="headerlink" title="卷映射"></a>卷映射</h2><blockquote>
<p>区分目录挂载和卷映射，可通过挂载的路径中是否包含 / 或者 ./来判断</p>
</blockquote>
<p>在 Docker 中，卷映射（Volume Mounting）是将 Docker 管理的卷（Volume）挂载到容器内的某个路径</p>
<p>Docker会自动创建一个存储位置，即使在容器初始启动的时候就和容器内部的文件保持完全一致。</p>
<p>映射后的配置文件会保持同步，即修改了宿主机映射的配置文件后，容器内部的配置文件也会同步修改</p>
<p>即使删除容器，卷内的数据仍会保存下来。</p>
<p>例如要映射nginx配置文件，启动时可以使用 <code>-v &lt;volume_name&gt;:/etc/nginx</code> 命令</p>
<p>映射的文件统一放在<code>/var/lib/docker/volumes/&lt;volume-name&gt;</code> 目录下</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令查看所有卷</span></span><br><span class="line">docker volume <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个卷</span></span><br><span class="line">docker volume create &lt;volume_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看卷信息</span></span><br><span class="line">docker volume inspect &lt;volume_name&gt;</span><br></pre></td></tr></tbody></table></figure>

<h1 id="Docker网络"><a href="#Docker网络" class="headerlink" title="Docker网络"></a>Docker网络</h1><p>docker 为每个容器分配了唯一IP，使容器IP + 端口可以互相访问，不过这个IP由于各种原因可能会变化</p>
<p>Docker每个应用启动的时候都会加入一个Docker的默认网络<code>docker0</code></p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ip addr 可以查到docker0相关信息</span></span><br><span class="line">6: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    <span class="built_in">link</span>/ether 02:42:63:90:8e:52 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:63ff:fe90:8e52/64 scope <span class="built_in">link</span></span><br></pre></td></tr></tbody></table></figure>

<p>也可以使用 <code>docker [container] inspect &lt;image name&gt;</code> 查看容器细节内容，可在<code>Networks</code>配置项中找到网关<code>Gateway</code> 和 IP地址 <code>IPAddress</code></p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"Networks"</span>: {</span><br><span class="line">                <span class="string">"bridge"</span>: {</span><br><span class="line">                    <span class="string">"IPAMConfig"</span>: null,</span><br><span class="line">                    <span class="string">"Links"</span>: null,</span><br><span class="line">                    <span class="string">"Aliases"</span>: null,</span><br><span class="line">                    <span class="string">"MacAddress"</span>: <span class="string">"02:42:ac:11:00:03"</span>,</span><br><span class="line">                    <span class="string">"NetworkID"</span>: <span class="string">"75e1075b52c1ed9dff76bb29a0d84c553839cc414c9ac4fdee04fae33329fc4e"</span>,</span><br><span class="line">                    <span class="string">"EndpointID"</span>: <span class="string">"190ce9d1618de4446460ff220629f743e923d7ad599d97fd0135d0d77884e98b"</span>,</span><br><span class="line">                    <span class="string">"Gateway"</span>: <span class="string">"172.17.0.1"</span>,</span><br><span class="line">                    <span class="string">"IPAddress"</span>: <span class="string">"172.17.0.3"</span>,</span><br><span class="line">                    <span class="string">"IPPrefixLen"</span>: 16,</span><br><span class="line">                    <span class="string">"IPv6Gateway"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"GlobalIPv6Address"</span>: <span class="string">""</span>,</span><br><span class="line">                    <span class="string">"GlobalIPv6PrefixLen"</span>: 0,</span><br><span class="line">                    <span class="string">"DriverOpts"</span>: null,</span><br><span class="line">                    <span class="string">"DNSNames"</span>: null</span><br><span class="line">                }</span><br><span class="line">            }</span><br></pre></td></tr></tbody></table></figure>



<p>为了形成稳定访问的网络，Docker提供了自定义网络机制，默认<code>docker0</code>是不支持使用主机域名访问，需要创建一个自定义网络，让启动的容器加入到自定义网络，容器的名称便可以作为一个稳定的域名</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个自定义网络</span></span><br><span class="line">docker network create &lt;network_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有docker网络</span></span><br><span class="line">docker network <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 容器启动时使用 --network 指定自定义网络</span></span><br><span class="line">docker run -d -p 88:80 --name app1 --network mynet nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用自定义网络作为域名进行访问,需使用内部端口</span></span><br><span class="line">[root@localhost docker]# docker <span class="built_in">exec</span> -it app1 bash</span><br><span class="line">root@411c92f75eb1:/# curl http://app2:80</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h1 id="实战练习"><a href="#实战练习" class="headerlink" title="实战练习"></a>实战练习</h1><h2 id="Redis主从同步集群"><a href="#Redis主从同步集群" class="headerlink" title="Redis主从同步集群"></a>Redis主从同步集群</h2><blockquote>
<p>此处使用非官方Redis镜像，预设好了很多环境变量，配置相对简单</p>
<p>镜像仓库地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/r/bitnami/redis">https://hub.docker.com/r/bitnami/redis</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66ead5126c2ad.png" alt="image-20240918212641107"></p>
<p>使用<code>-e</code> 配置环境变量</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">    -e ALLOW_EMPTY_PASSWORD=<span class="built_in">yes</span> \</span><br><span class="line">    -v /path/to/redis-persistence:/bitnami/redis/data \</span><br><span class="line">    bitnami/redis:latest</span><br></pre></td></tr></tbody></table></figure>

<p>例如此处使用下列命令</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自定义网络</span></span><br><span class="line">docker network create mynet</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主节点 redis01</span></span><br><span class="line">docker run -d -p 6379:6379 \</span><br><span class="line">	-v /home/docker/redis/redis01:/bitnami/redis/data \</span><br><span class="line">	-e REDIS_REPLICATION_MODE=master \</span><br><span class="line">	-e REDIS_PASSWORD=shiguang \</span><br><span class="line">	--network mynet --name redis01 \</span><br><span class="line">	bitnami/redis</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此时Redis并未处于运行状态,因为映射的文件没有操作权限</span></span><br><span class="line"><span class="comment"># 给目录授予权限</span></span><br><span class="line"><span class="built_in">chmod</span> -R 777 /home/docker/redis/redis01</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启实例</span></span><br><span class="line">docker restart redis01</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用于映射redis02目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /home/docker/redis/redis02</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给redis02映射目录赋予操作权限</span></span><br><span class="line"><span class="built_in">chmod</span> -R 777 /home/docker/redis/redis02</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从节点 redis02</span></span><br><span class="line">docker run -d -p 6380:6379 \</span><br><span class="line">	-v /home/docker/redis/redis02:/bitnami/redis/data \</span><br><span class="line">	-e REDIS_REPLICATION_MODE=slave \</span><br><span class="line">	-e REDIS_MASTER_HOST=redis01 \</span><br><span class="line">	-e REDIS_MASTER_PORT_NUMBER=6379 \</span><br><span class="line">	-e REDIS_MASTER_PASSWORD=shiguang \</span><br><span class="line">	-e REDIS_PASSWORD=shiguang \</span><br><span class="line">	--network mynet --name redis02 \</span><br><span class="line">	bitnami/redis</span><br></pre></td></tr></tbody></table></figure>

<p>启动成功后可在使用Redis Desktop Manager</p>
<blockquote>
<p>官方(需要订阅)：<a target="_blank" rel="noopener" href="https://github.com/RedisInsight/RedisDesktopManager/releases">https://github.com/RedisInsight/RedisDesktopManager/releases</a></p>
<p>百度网盘：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1MVPdXth7Tu2x-d_rMRHuXA?pwd=yyds">redis-desktop-manager-0.8.8.384.exe</a>、</p>
</blockquote>
<p>连接两个Redis服务</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eae26720a44.png" alt="image-20240918222334423"></p>
<p>往主节点添加一个key</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eae2ae4956e.png" alt="image-20240918222446301"></p>
<p>刷新从节点，已自动同步主节点数据</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eae2cbd87a8.png" alt="image-20240918222513840"></p>
<h2 id="启动MySQL"><a href="#启动MySQL" class="headerlink" title="启动MySQL"></a>启动MySQL</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 \</span><br><span class="line">-v /home/docker/mysql/config:/etc/mysql/conf.d \</span><br><span class="line">-v /home/docker/mysql/data:/var/lib/mysql \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=shiguang \</span><br><span class="line">--name mysql \</span><br><span class="line">mysql:8.0.37-debian</span><br></pre></td></tr></tbody></table></figure>

<h1 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker compose"></a>Docker compose</h1><p>Docker Compose 是一个用于定义和运行多容器 Docker 应用程序的工具。通过使用 YAML 文件来配置应用程序的服务、网络和卷，Docker Compose 可以轻松地启动、停止和管理多个容器。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eae62c3ff76.png" alt="image-20240918223940012"></p>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>Docker Compose 提供了许多命令来管理多容器应用程序。以下是一些常用的 Docker Compose 命令及其用法：</p>
<h3 id="docker-compose-up"><a href="#docker-compose-up" class="headerlink" title="docker-compose up"></a><code>docker-compose up</code></h3><p><strong>功能</strong>：启动服务。</p>
<p><strong>常用选项</strong>：</p>
<ul>
<li><code>-d</code>：在后台运行服务。</li>
<li><code>--build</code>：在启动服务之前构建镜像。</li>
<li><code>--force-recreate</code>：强制重新创建容器，即使它们的配置和镜像没有改变。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-down"><a href="#docker-compose-down" class="headerlink" title="docker-compose down"></a><code>docker-compose down</code></h3><p><strong>功能</strong>：停止并删除服务。</p>
<p><strong>常用选项</strong>：</p>
<ul>
<li><code>-v</code>：删除与服务关联的卷。</li>
<li><code>--rmi all</code>：删除所有与服务关联的镜像。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down -v</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-ps"><a href="#docker-compose-ps" class="headerlink" title="docker-compose ps"></a><code>docker-compose ps</code></h3><p><strong>功能</strong>：列出正在运行的服务。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-logs"><a href="#docker-compose-logs" class="headerlink" title="docker-compose logs"></a><code>docker-compose logs</code></h3><p><strong>功能</strong>：查看服务的日志。</p>
<p><strong>常用选项</strong>：</p>
<ul>
<li><code>-f</code>：实时跟踪日志输出。</li>
<li><code>--tail=N</code>：只显示最后 N 行日志。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose logs -f</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-build"><a href="#docker-compose-build" class="headerlink" title="docker-compose build"></a><code>docker-compose build</code></h3><p><strong>功能</strong>：构建服务镜像。</p>
<p><strong>常用选项</strong>：</p>
<ul>
<li><code>--no-cache</code>：不使用缓存构建镜像。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose build --no-cache</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-exec"><a href="#docker-compose-exec" class="headerlink" title="docker-compose exec"></a><code>docker-compose exec</code></h3><p><strong>功能</strong>：在运行的容器中执行命令。</p>
<p><strong>常用选项</strong>：</p>
<ul>
<li><code>-T</code>：禁用 TTY 分配。</li>
<li><code>-u</code>：指定用户。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="built_in">exec</span> web bash</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-start"><a href="#docker-compose-start" class="headerlink" title="docker-compose start"></a><code>docker-compose start</code></h3><p><strong>功能</strong>：启动已停止的服务。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose start</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-stop"><a href="#docker-compose-stop" class="headerlink" title="docker-compose stop"></a><code>docker-compose stop</code></h3><p><strong>功能</strong>：停止正在运行的服务。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose stop</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-restart"><a href="#docker-compose-restart" class="headerlink" title="docker-compose restart"></a><code>docker-compose restart</code></h3><p><strong>功能</strong>：重启服务。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose restart</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-pull"><a href="#docker-compose-pull" class="headerlink" title="docker-compose pull"></a><code>docker-compose pull</code></h3><p><strong>功能</strong>：拉取服务的镜像。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose pull</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-config"><a href="#docker-compose-config" class="headerlink" title="docker-compose config"></a><code>docker-compose config</code></h3><p><strong>功能</strong>：验证并查看 <code>docker-compose.yml</code> 文件的配置。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose config</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-run"><a href="#docker-compose-run" class="headerlink" title="docker-compose run"></a><code>docker-compose run</code></h3><p><strong>功能</strong>：运行一次性命令。</p>
<p><strong>常用选项</strong>：</p>
<ul>
<li><code>-e</code>：设置环境变量。</li>
<li><code>--rm</code>：命令完成后删除容器。</li>
</ul>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose run web python manage.py migrate</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-scale"><a href="#docker-compose-scale" class="headerlink" title="docker-compose scale"></a><code>docker-compose scale</code></h3><p><strong>功能</strong>：扩展服务的实例数量。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose scale web=3</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-port"><a href="#docker-compose-port" class="headerlink" title="docker-compose port"></a><code>docker-compose port</code></h3><p><strong>功能</strong>：查看服务的端口映射。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose port web 80</span><br></pre></td></tr></tbody></table></figure>

<h3 id="docker-compose-top"><a href="#docker-compose-top" class="headerlink" title="docker-compose top"></a><code>docker-compose top</code></h3><p><strong>功能</strong>：查看正在运行的进程。</p>
<p><strong>示例</strong>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose top</span><br></pre></td></tr></tbody></table></figure>

<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>Docker Compose 提供了丰富的命令来管理多容器应用程序。通过这些命令，可以轻松地启动、停止、重启、构建、查看日志和管理容器。合理使用这些命令可以大大简化开发和部署流程。</p>
<h2 id="使用Docker-compose启动wordpress"><a href="#使用Docker-compose启动wordpress" class="headerlink" title="使用Docker compose启动wordpress"></a>使用Docker compose启动wordpress</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eae6b73f612.png" alt="image-20240918224158842"></p>
<blockquote>
<p><code>docker run</code> 命令中的 <code>--restart</code> 选项用于指定容器在退出时 Docker 守护进程应如何处理容器的重启策略。这个选项非常有用，特别是在生产环境中，确保容器在意外退出时能够自动重启，从而提高服务的可用性。</p>
<h3 id="restart-的作用"><a href="#restart-的作用" class="headerlink" title="--restart 的作用"></a><code>--restart</code> 的作用</h3><p><code>--restart</code> 选项允许你定义容器的重启策略，主要有以下几种策略：</p>
<ol>
<li>**<code>no</code>**：默认策略，容器退出时不会自动重启。</li>
<li>**<code>on-failure</code>**：只有在容器非正常退出（即退出状态码不为 0）时才会自动重启。</li>
<li>**<code>always</code>**：无论容器以何种状态退出，都会自动重启。</li>
<li>**<code>unless-stopped</code>**：与 <code>always</code> 类似，但当容器被手动停止（使用 <code>docker stop</code> 或 <code>docker-compose down</code>）后，即使 Docker 守护进程重启，容器也不会自动启动。</li>
</ol>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建网络</span></span><br><span class="line">docker network create blog</span><br><span class="line"></span><br><span class="line"><span class="comment">#启动mysql</span></span><br><span class="line">docker run -d -p 3306:3306 \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=shiguang \</span><br><span class="line">-e MYSQL_DATABASE=wordpress \</span><br><span class="line">-v mysql-data:/var/lib/mysql \</span><br><span class="line">-v /home/mysql/config:/etc/mysql/conf.d \</span><br><span class="line">--restart always --name mysql \</span><br><span class="line">--network blog \</span><br><span class="line">mysql:8.0</span><br><span class="line"></span><br><span class="line"><span class="comment">#启动wordpress</span></span><br><span class="line">docker run -d -p 8080:80 \</span><br><span class="line">-e WORDPRESS_DB_HOST=mysql \</span><br><span class="line">-e WORDPRESS_DB_USER=root \</span><br><span class="line">-e WORDPRESS_DB_PASSWORD=shiguang \</span><br><span class="line">-e WORDPRESS_DB_NAME=wordpress \</span><br><span class="line">-v wordpress:/var/www/html \</span><br><span class="line">--restart always --name wordpress-app \</span><br><span class="line">--network blog \</span><br><span class="line">wordpress:latest</span><br></pre></td></tr></tbody></table></figure>



<h2 id="compose-yaml"><a href="#compose-yaml" class="headerlink" title="compose.yaml"></a>compose.yaml</h2><blockquote>
<p>官方文档： <a target="_blank" rel="noopener" href="https://docs.docker.com/reference/compose-file/">https://docs.docker.com/reference/compose-file/</a></p>
</blockquote>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">myblog</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"3306:3306"</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=shiguang</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=wordpress</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql-data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/home/docker/mysql/conf:/etc/mysql/conf.d</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">blog</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">wordpress:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">wordpress</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"8080:80"</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_HOST:</span> <span class="string">mysql</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_USER:</span> <span class="string">root</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_PASSWORD:</span> <span class="string">shiguang</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_NAME:</span> <span class="string">wordpress</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">wordpress:/var/www/html</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">blog</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql-data:</span></span><br><span class="line">  <span class="attr">wordpress:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">blog:</span></span><br></pre></td></tr></tbody></table></figure>

<p>切换到Docker Compose 文件目录，执行 <code>docker compose up -d</code> 启动</p>
<p>启动时也可用 <code>-f</code>指定Docker Compose 文件文件名</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose -f compose.yml up -d</span><br></pre></td></tr></tbody></table></figure>



<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><h3 id="增量更新"><a href="#增量更新" class="headerlink" title="增量更新"></a>增量更新</h3><p>修改 Docker Compose 文件。重新启动应用。只会触发修改项的重新启动。</p>
<h3 id="数据不删"><a href="#数据不删" class="headerlink" title="数据不删"></a>数据不删</h3><p>默认就算down了容器，所有挂载的卷不会被移除。比较安全</p>
<p>如果要删除容器的同时删除所有卷，可以使用以下命令</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose down --rmi all -v</span><br></pre></td></tr></tbody></table></figure>

<h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><blockquote>
<p>官方文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/dockerfile/">https://docs.docker.com/reference/dockerfile/</a></p>
</blockquote>
<p>切换到jar包所在目录，通过<code>java -jar &lt;jar_file&gt;</code> 启动服务，可以通过<code>--server.port xxx</code>指定启动端口</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eaf382b9dc5.png" alt="image-20240918233634410"></p>
<h2 id="通过Dockerfile构建-镜像"><a href="#通过Dockerfile构建-镜像" class="headerlink" title="通过Dockerfile构建 镜像"></a>通过Dockerfile构建 镜像</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eaf48390393.png" alt="image-20240918234051330"></p>
<p>以下是一个简单的示例，文件名称<code>Dockerfile</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:17</span><br><span class="line"></span><br><span class="line">LABEL author=shiguang</span><br><span class="line"></span><br><span class="line">COPY app.jar /app.jar</span><br><span class="line"></span><br><span class="line">EXPOSE 8080</span><br><span class="line"></span><br><span class="line">ENTRYPOINT ["java","-jar","/app.jar"]</span><br></pre></td></tr></tbody></table></figure>

<p>在当前目录下执行，其中<code>-t</code> 代表tag指定版本，<code>.</code>代表当前目录</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -f Dockerfile -t myjavaapp:v1.0 .</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eaf7ef9827a.png" alt="image-20240918235527420"></p>
<p>构建好后即可通过<code>docker images</code> 查看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eaf80042c92.png" alt="image-20240918235544399"></p>
<h2 id="镜像分层存储机制"><a href="#镜像分层存储机制" class="headerlink" title="镜像分层存储机制"></a>镜像分层存储机制</h2><p>Docker 的分层存储机制是其核心特性之一，它使得镜像的构建、共享和部署变得高效且灵活。分层存储机制通过将镜像和容器的数据存储在不同的层中，实现了镜像的轻量化和快速部署。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/18/66eaf871df20a.png" alt="image-20240918235737653"></p>
<h3 id="分层存储的概念"><a href="#分层存储的概念" class="headerlink" title="分层存储的概念"></a><strong>分层存储的概念</strong></h3><p>Docker 镜像是由一系列只读层（Read-Only Layers）组成的。每一层代表镜像构建过程中的一个步骤，例如安装软件包、添加文件或修改配置。这些层是只读的，一旦创建就不能修改。当容器启动时，Docker 会在这些只读层之上添加一个可写层（Writable Layer），用于存储容器运行时的修改。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/09/19/66eaf93846e4b.png" alt="image-20240919000055685"></p>
<h3 id="分层存储的实现"><a href="#分层存储的实现" class="headerlink" title="分层存储的实现"></a><strong>分层存储的实现</strong></h3><h4 id="镜像层"><a href="#镜像层" class="headerlink" title="镜像层"></a><strong>镜像层</strong></h4><ul>
<li><strong>只读层</strong>：镜像的每一层都是只读的，一旦创建就不能修改。每一层都有一个唯一的标识符（Layer ID），用于在不同的镜像之间共享。</li>
<li><strong>层的内容</strong>：每一层包含了文件系统的变化，例如添加、删除或修改的文件。这些变化以增量方式存储，只有发生变化的部分会被存储。</li>
</ul>
<h4 id="容器层"><a href="#容器层" class="headerlink" title="容器层"></a><strong>容器层</strong></h4><ul>
<li><strong>可写层</strong>：当容器启动时，Docker 会在镜像的最上层添加一个可写层。容器运行时的所有修改（例如创建新文件、修改文件、删除文件）都会存储在这个可写层中。</li>
<li><strong>临时性</strong>：容器层的修改是临时的，当容器停止或删除时，这些修改会丢失。如果需要持久化数据，可以使用卷（Volume）或绑定挂载（Bind Mount）。</li>
</ul>
<h3 id="分层存储的示例"><a href="#分层存储的示例" class="headerlink" title="分层存储的示例"></a><strong>分层存储的示例</strong></h3><p>假设我们有一个简单的 Dockerfile：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:20.04</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y nginx</span><br><span class="line">COPY index.html /var/www/html/</span><br><span class="line">CMD ["nginx", "-g", "daemon off;"]</span><br></pre></td></tr></tbody></table></figure>

<p>在这个 Dockerfile 中，镜像的构建过程可以分为以下几层：</p>
<ol>
<li><strong>基础层</strong>：<code>ubuntu:20.04</code> 镜像。</li>
<li><strong>更新和安装层</strong>：<code>RUN apt-get update &amp;&amp; apt-get install -y nginx</code>。</li>
<li><strong>文件复制层</strong>：<code>COPY index.html /var/www/html/</code>。</li>
<li><strong>启动命令层</strong>：<code>CMD ["nginx", "-g", "daemon off;"]</code>。</li>
</ol>
<p>每一层都是一个只读层，当容器启动时，Docker 会在这些只读层之上添加一个可写层。</p>
<h1 id="附录：一键安装超多中间件"><a href="#附录：一键安装超多中间件" class="headerlink" title="附录：一键安装超多中间件"></a>附录：一键安装超多中间件</h1><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Disable memory paging and swapping performance</span></span><br><span class="line"><span class="built_in">sudo</span> swapoff -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit the sysctl config file</span></span><br><span class="line"><span class="built_in">sudo</span> vi /etc/sysctl.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a line to define the desired value</span></span><br><span class="line"><span class="comment"># or change the value if the key exists,</span></span><br><span class="line"><span class="comment"># and then save your changes.</span></span><br><span class="line">vm.max_map_count=262144</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reload the kernel parameters using sysctl</span></span><br><span class="line"><span class="built_in">sudo</span> sysctl -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># Verify that the change was applied by checking the value</span></span><br><span class="line"><span class="built_in">cat</span> /proc/sys/vm/max_map_count</span><br></pre></td></tr></tbody></table></figure>



<h2 id="yaml"><a href="#yaml" class="headerlink" title="yaml"></a>yaml</h2><blockquote>
<p>注意：</p>
<ul>
<li>将下面文件中 kafka 的  119.45.147.122 改为你自己的服务器IP。</li>
<li>所有容器都做了时间同步，这样容器的时间和linux主机的时间就一致了<br>准备一个 <code>compose.yaml</code>文件，内容如下：</li>
</ul>
</blockquote>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">devsoft</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">bitnami/redis:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REDIS_PASSWORD=123456</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">'6379:6379'</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis-data:/bitnami/redis/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis-conf:/opt/bitnami/redis/mounted-etc</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0.31</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=123456</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">'3306:3306'</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">'33060:33060'</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql-conf:/etc/mysql/conf.d</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql-data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">rabbit:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">rabbitmq:3-management</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rabbitmq</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"5672:5672"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"15672:15672"</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">RABBITMQ_DEFAULT_USER=rabbit</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">RABBITMQ_DEFAULT_PASS=rabbit</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">RABBITMQ_DEFAULT_VHOST=dev</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">rabbit-data:/var/lib/rabbitmq</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">rabbit-app:/etc/rabbitmq</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">  <span class="attr">opensearch-node1:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">opensearchproject/opensearch:2.13.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">opensearch-node1</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=opensearch-cluster</span> <span class="comment"># Name the cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node.name=opensearch-node1</span> <span class="comment"># Name the node that will run in this container</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.seed_hosts=opensearch-node1,opensearch-node2</span> <span class="comment"># Nodes to look for when discovering the cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.initial_cluster_manager_nodes=opensearch-node1,opensearch-node2</span> <span class="comment"># Nodes eligibile to serve as cluster manager</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span> <span class="comment"># Disable JVM heap memory swapping</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m"</span> <span class="comment"># Set min and max JVM heap sizes to at least 50% of system RAM</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"DISABLE_INSTALL_DEMO_CONFIG=true"</span> <span class="comment"># Prevents execution of bundled demo script which installs demo certificates and security configurations to OpenSearch</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"DISABLE_SECURITY_PLUGIN=true"</span> <span class="comment"># Disables Security plugin</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span> <span class="comment"># Set memlock to unlimited (no soft or hard limit)</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">      <span class="attr">nofile:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">65536</span> <span class="comment"># Maximum number of open files for the opensearch user - set to at least 65536</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">65536</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">opensearch-data1:/usr/share/opensearch/data</span> <span class="comment"># Creates volume called opensearch-data1 and mounts it to the container</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9200</span><span class="string">:9200</span> <span class="comment"># REST API</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9600</span><span class="string">:9600</span> <span class="comment"># Performance Analyzer</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">opensearch-node2:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">opensearchproject/opensearch:2.13.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">opensearch-node2</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.name=opensearch-cluster</span> <span class="comment"># Name the cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node.name=opensearch-node2</span> <span class="comment"># Name the node that will run in this container</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">discovery.seed_hosts=opensearch-node1,opensearch-node2</span> <span class="comment"># Nodes to look for when discovering the cluster</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cluster.initial_cluster_manager_nodes=opensearch-node1,opensearch-node2</span> <span class="comment"># Nodes eligibile to serve as cluster manager</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bootstrap.memory_lock=true</span> <span class="comment"># Disable JVM heap memory swapping</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m"</span> <span class="comment"># Set min and max JVM heap sizes to at least 50% of system RAM</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"DISABLE_INSTALL_DEMO_CONFIG=true"</span> <span class="comment"># Prevents execution of bundled demo script which installs demo certificates and security configurations to OpenSearch</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"DISABLE_SECURITY_PLUGIN=true"</span> <span class="comment"># Disables Security plugin</span></span><br><span class="line">    <span class="attr">ulimits:</span></span><br><span class="line">      <span class="attr">memlock:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">-1</span> <span class="comment"># Set memlock to unlimited (no soft or hard limit)</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">-1</span></span><br><span class="line">      <span class="attr">nofile:</span></span><br><span class="line">        <span class="attr">soft:</span> <span class="number">65536</span> <span class="comment"># Maximum number of open files for the opensearch user - set to at least 65536</span></span><br><span class="line">        <span class="attr">hard:</span> <span class="number">65536</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">opensearch-data2:/usr/share/opensearch/data</span> <span class="comment"># Creates volume called opensearch-data2 and mounts it to the container</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">opensearch-dashboards:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">opensearchproject/opensearch-dashboards:2.13.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">opensearch-dashboards</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5601</span><span class="string">:5601</span> <span class="comment"># Map host port 5601 to container port 5601</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"5601"</span> <span class="comment"># Expose port 5601 for web access to OpenSearch Dashboards</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">'OPENSEARCH_HOSTS=["http://opensearch-node1:9200","http://opensearch-node2:9200"]'</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"DISABLE_SECURITY_DASHBOARDS_PLUGIN=true"</span> <span class="comment"># disables security dashboards plugin in OpenSearch Dashboards</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">  <span class="attr">zookeeper:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">bitnami/zookeeper:3.9</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">zookeeper</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"2181:2181"</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"zookeeper_data:/bitnami"</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ALLOW_ANONYMOUS_LOGIN=yes</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">kafka:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">'bitnami/kafka:3.4'</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kafka</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">kafka</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">'9092:9092'</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">'9094:9094'</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_NODE_ID=0</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_PROCESS_ROLES=controller,broker</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_LISTENERS=PLAINTEXT://:9092,CONTROLLER://:9093,EXTERNAL://0.0.0.0:9094</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092,EXTERNAL://119.45.147.122:9094</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=CONTROLLER:PLAINTEXT,EXTERNAL:PLAINTEXT,PLAINTEXT:PLAINTEXT</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_CONTROLLER_QUORUM_VOTERS=0@kafka:9093</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KAFKA_CFG_CONTROLLER_LISTENER_NAMES=CONTROLLER</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ALLOW_PLAINTEXT_LISTENER=yes</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"KAFKA_HEAP_OPTS=-Xmx512m -Xms512m"</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">kafka-conf:/bitnami/kafka/config</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">kafka-data:/bitnami/kafka/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">  <span class="attr">kafka-ui:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">kafka-ui</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">provectuslabs/kafka-ui:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">DYNAMIC_CONFIG_ENABLED:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_NAME:</span> <span class="string">kafka-dev</span></span><br><span class="line">      <span class="attr">KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS:</span> <span class="string">kafka:9092</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">kafkaui-app:/etc/kafkaui</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nacos:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nacos/nacos-server:v2.3.1</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nacos</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8848</span><span class="string">:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9848</span><span class="string">:9848</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PREFER_HOST_MODE=hostname</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MODE=standalone</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMX=512m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMS=512m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PLATFORM=mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_HOST=nacos-mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_DB_NAME=nacos_devtest</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_PORT=3306</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_USER=nacos</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_PASSWORD=nacos</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_DB_PARAM=characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">NACOS_AUTH_IDENTITY_KEY=2222</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">NACOS_AUTH_IDENTITY_VALUE=2xxx</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">NACOS_AUTH_TOKEN=SecretKey012345678901234567890123456789012345678901234567890123456789</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">NACOS_AUTH_ENABLE=true</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/app/nacos/standalone-logs/:/home/nacos/logs</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="attr">nacos-mysql:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">service_healthy</span></span><br><span class="line">  <span class="attr">nacos-mysql:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nacos-mysql</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile_inline:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        FROM mysql:8.0.31</span></span><br><span class="line"><span class="string">        ADD https://raw.githubusercontent.com/alibaba/nacos/2.3.2/distribution/conf/mysql-schema.sql /docker-entrypoint-initdb.d/nacos-mysql.sql</span></span><br><span class="line"><span class="string">        RUN chown -R mysql:mysql /docker-entrypoint-initdb.d/nacos-mysql.sql</span></span><br><span class="line"><span class="string">        EXPOSE 3306</span></span><br><span class="line"><span class="string">        CMD ["mysqld", "--character-set-server=utf8mb4", "--collation-server=utf8mb4_unicode_ci"]</span></span><br><span class="line"><span class="string"></span>    <span class="attr">image:</span> <span class="string">nacos/mysql:8.0.30</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=nacos_devtest</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_USER=nacos</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=nacos</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">LANG=C.UTF-8</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nacos-mysqldata:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"13306:3306"</span></span><br><span class="line">    <span class="attr">healthcheck:</span></span><br><span class="line">      <span class="attr">test:</span> [ <span class="string">"CMD"</span>, <span class="string">"mysqladmin"</span> ,<span class="string">"ping"</span>, <span class="string">"-h"</span>, <span class="string">"localhost"</span> ]</span><br><span class="line">      <span class="attr">interval:</span> <span class="string">5s</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">retries:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">prometheus:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">prom/prometheus:v2.52.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">prometheus</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9090</span><span class="string">:9090</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">prometheus-data:/prometheus</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">prometheus-conf:/etc/prometheus</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">grafana:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">grafana/grafana:10.4.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">grafana</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3000</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">grafana-data:/var/lib/grafana</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime:ro</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">redis-data:</span></span><br><span class="line">  <span class="attr">redis-conf:</span></span><br><span class="line">  <span class="attr">mysql-conf:</span></span><br><span class="line">  <span class="attr">mysql-data:</span></span><br><span class="line">  <span class="attr">rabbit-data:</span></span><br><span class="line">  <span class="attr">rabbit-app:</span></span><br><span class="line">  <span class="attr">opensearch-data1:</span></span><br><span class="line">  <span class="attr">opensearch-data2:</span></span><br><span class="line">  <span class="attr">nacos-mysqldata:</span></span><br><span class="line">  <span class="attr">zookeeper_data:</span></span><br><span class="line">  <span class="attr">kafka-conf:</span></span><br><span class="line">  <span class="attr">kafka-data:</span></span><br><span class="line">  <span class="attr">kafkaui-app:</span></span><br><span class="line">  <span class="attr">prometheus-data:</span></span><br><span class="line">  <span class="attr">prometheus-conf:</span></span><br><span class="line">  <span class="attr">grafana-data:</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><blockquote>
<p>tip：如果重启了服务器，可能有些容器会启动失败。再执行一遍 docker compose up -d即可。所有程序都可运行成功，并且不会丢失数据。请放心使用。</p>
</blockquote>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 compose.yaml 文件所在的目录下执行</span></span><br><span class="line">docker compose up -d</span><br><span class="line"><span class="comment"># 等待启动所有容器</span></span><br></pre></td></tr></tbody></table></figure>



<h2 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h2><blockquote>
<p>zookeeper可视化工具下载：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/vran-dev/PrettyZoo/releases/download/v2.1.1/prettyZoo-win.zip">https://github.com/vran-dev/PrettyZoo/releases/download/v2.1.1/prettyZoo-win.zip</a></p>
<p>redis可视化工具下载：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/qishibo/AnotherRedisDesktopManager/releases/download/v1.6.4/Another-Redis-Desktop-Manager.1.6.4.exe">https://github.com/qishibo/AnotherRedisDesktopManager/releases/download/v1.6.4/Another-Redis-Desktop-Manager.1.6.4.exe</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>组件（容器名）</th>
<th>介绍</th>
<th>访问地址</th>
<th>账号/密码</th>
<th>特性</th>
</tr>
</thead>
<tbody><tr>
<td>Redis(redis)</td>
<td>k-v 库</td>
<td>你的ip:6379</td>
<td>单密码模式：123456</td>
<td>已开启AOF</td>
</tr>
<tr>
<td>MySQL(mysql)</td>
<td>数据库</td>
<td>你的ip:3306</td>
<td>root/123456</td>
<td>默认utf8mb4字符集</td>
</tr>
<tr>
<td>Rabbit(rabbit)</td>
<td>消息队列</td>
<td>你的ip:15672</td>
<td>rabbit/rabbit</td>
<td>暴露5672和15672端口</td>
</tr>
<tr>
<td>OpenSearch(opensearch-node1/2)</td>
<td>检索引擎</td>
<td>你的ip:9200</td>
<td></td>
<td>内存512mb；两个节点</td>
</tr>
<tr>
<td>opensearch-dashboards</td>
<td>search可视化</td>
<td>你的ip:5601</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Zookeeper(zookeeper)</td>
<td>分布式协调</td>
<td>你的ip:2181</td>
<td></td>
<td>允许匿名登录</td>
</tr>
<tr>
<td>kafka(kafka)</td>
<td>消息队列</td>
<td>你的ip:9092 外部访问:9094</td>
<td></td>
<td>占用内存512mb</td>
</tr>
<tr>
<td>kafka-ui(kafka-ui)</td>
<td>kafka可视化</td>
<td>你的ip:8080</td>
<td></td>
<td></td>
</tr>
<tr>
<td>nacos(nacos)</td>
<td>注册/配置中心</td>
<td>你的ip:8848</td>
<td>nacos/nacos</td>
<td>持久化数据到MySQL</td>
</tr>
<tr>
<td>nacos-mysql(nacos-mysql)</td>
<td>nacos配套数据库</td>
<td>你的ip:13306</td>
<td>root/root</td>
<td></td>
</tr>
<tr>
<td>prometheus(prometheus)</td>
<td>时序数据库</td>
<td>你的ip:9090</td>
<td></td>
<td></td>
</tr>
<tr>
<td>grafana(grafana)</td>
<td></td>
<td>你的ip:3000</td>
<td>admin/admin</td>
<td></td>
</tr>
</tbody></table>
</div></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">時光</div><div class="post-copyright__author_desc">心寄朗朗乾坤，胸怀真修之道。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/')">【尚硅谷】Docker快速通关</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.png" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=【尚硅谷】Docker快速通关&amp;url=https://blog.shiguang666.eu.org/2024/09/18/847c1ec4d4cd/&amp;pic=https://img.shiguangdev.cn/i/2024/08/28/66cedaf5d014a.jpeg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shiguang666.eu.org" target="_blank">時光</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Docker/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Docker<span class="tagsPageCount">14</span></a><a class="post-meta__box__tags" href="/tags/%E5%B0%9A%E7%A1%85%E8%B0%B7/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>尚硅谷<span class="tagsPageCount">42</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://img.shiguangdev.cn/i/2024/12/18/6762e71b2e658.webp" data-sites="wechat,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/17/ef5bcf52c331/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/08/28/66cedaf5d014a.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【尚硅谷】JAVA基础-JDK新特性</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/19/720ec24d3d9d/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/08/28/66cedaf5d014a.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【尚硅谷】Nginx</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2023/12/26/38e72e804f0c/" title="【Docker】部署ChatBotUI"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/10/18/671251a94f7a9.png?_r_=8d2ee9bf-f274-3e60-a181-7da599f11600" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-26</div><div class="title">【Docker】部署ChatBotUI</div></div></a></div><div><a href="/2024/01/12/c1b68bdcee85/" title="【Docker】部署ChatGPT Next Web"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/10/16/670fb34ebe4c2.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-01-12</div><div class="title">【Docker】部署ChatGPT Next Web</div></div></a></div><div><a href="/2024/01/15/2915cd293192/" title="【Docker】部署Nginx Proxy Manager"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/10/18/671251f4ea790.png?_r_=86e6e0a3-e264-857a-29bd-4690a68c44fa" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-01-15</div><div class="title">【Docker】部署Nginx Proxy Manager</div></div></a></div><div><a href="/2024/01/08/3f4d884b5ab1/" title="【Docker】部署PandoraNext"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/10/18/671251983e830.png?_r_=7c320a99-84e1-bd76-a6f9-96cca73265a0" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-01-08</div><div class="title">【Docker】部署PandoraNext</div></div></a></div><div><a href="/2024/01/16/8f7219efea68/" title="【Docker】部署chatgpt-on-wechat"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/10/18/671251983e830.png?_r_=ca438c06-eaa1-b700-6936-f3f77ac7b6d4" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-01-16</div><div class="title">【Docker】部署chatgpt-on-wechat</div></div></a></div><div><a href="/2023/12/16/45487f77bf38/" title="【Docker】部署可视化面板-Portainer"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/10/18/671251a94f7a9.png?_r_=a02c427a-659e-8cb7-1a13-055e8f72ab16" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-12-16</div><div class="title">【Docker】部署可视化面板-Portainer</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)" style="display: none">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://emotion.acs.pw/emotion/Heo/送福.png" alt="status"></div></div><div class="author-info__description">代码成就万事基积沙镇海,<br>梦想永在凌云意意气风发。</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">時光</h1><div class="author-info__desc">心寄朗朗乾坤，胸怀真修之道。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/shiguang-coding" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content"><span>🌟欢迎光临時光的博客园子🌟</span><br> <span><a target="_blank" rel="noopener" href="https://blog.shiguangdev.cn"><b>blog.shiguangdev.cn</b></a></span><br> <span><a target="_blank" rel="noopener" href="https://blog.shiguang88.icu"><b>blog.shiguang88.icu</b></a></span><br> <span><a href="https://blog.shiguang666.eu.org"><b>blog.shiguang666.eu.org</b></a></span><br> <span>🤔 如有问题欢迎评论区交流！</span><br> <span>📧 如需联系我：<a href="mailto:an_shiguang@163.com"><b>发送邮件🚀</b></a></span> <div id="welcome-info"></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">Docker介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E4%BC%98%E5%8A%BF"><span class="toc-number">1.1.</span> <span class="toc-text">Docker优势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%87%B4%E7%9A%84%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.1.</span> <span class="toc-text">一致的环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E6%80%A7"><span class="toc-number">1.1.2.</span> <span class="toc-text">隔离性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%80%A7"><span class="toc-number">1.1.3.</span> <span class="toc-text">可移植性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2%E5%92%8C%E6%89%A9%E5%B1%95"><span class="toc-number">1.1.4.</span> <span class="toc-text">快速部署和扩展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%92%8C%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.5.</span> <span class="toc-text">版本控制和依赖管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E6%95%88%E7%8E%87"><span class="toc-number">1.1.6.</span> <span class="toc-text">资源效率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BE%E5%8C%BA%E5%92%8C%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.7.</span> <span class="toc-text">社区和生态系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-number">1.1.8.</span> <span class="toc-text">简化开发流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">Docker组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-CLI-%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.2.1.</span> <span class="toc-text">Docker CLI (命令行接口)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-Host-Docker-%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">Docker Host (Docker 守护进程)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8-Container"><span class="toc-number">1.2.3.</span> <span class="toc-text">容器 (Container)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F-Image"><span class="toc-number">1.2.4.</span> <span class="toc-text">镜像 (Image)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%93%E5%BA%93-Registry"><span class="toc-number">1.2.5.</span> <span class="toc-text">仓库 (Registry)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%80%BB%E7%BB%93"><span class="toc-number">1.2.6.</span> <span class="toc-text">关系总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">应用程序部署方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E9%83%A8%E7%BD%B2-Traditional-Deployment"><span class="toc-number">1.3.1.</span> <span class="toc-text">传统部署 (Traditional Deployment)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%8C%96%E9%83%A8%E7%BD%B2-Virtualization-Deployment"><span class="toc-number">1.3.2.</span> <span class="toc-text">虚拟化部署 (Virtualization Deployment)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2-Container-Deployment"><span class="toc-number">1.3.3.</span> <span class="toc-text">容器部署 (Container Deployment)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="toc-number">2.</span> <span class="toc-text">安装Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4%E6%97%A7%E7%89%88%E6%9C%AC"><span class="toc-number">2.1.</span> <span class="toc-text">移除旧版本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ubuntu-Debian"><span class="toc-number">2.1.1.</span> <span class="toc-text">Ubuntu/Debian</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Docker-Engine"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">卸载 Docker Engine</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Docker-Compose%EF%BC%88%E5%A6%82%E6%9E%9C%E5%AE%89%E8%A3%85%E4%BA%86%EF%BC%89"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">卸载 Docker Compose（如果安装了）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CentOS-RHEL"><span class="toc-number">2.1.2.</span> <span class="toc-text">CentOS/RHEL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Docker-Engine-1"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">卸载 Docker Engine</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Docker-Compose%EF%BC%88%E5%A6%82%E6%9E%9C%E5%AE%89%E8%A3%85%E4%BA%86%EF%BC%89-1"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">卸载 Docker Compose（如果安装了）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows"><span class="toc-number">2.1.3.</span> <span class="toc-text">Windows</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Docker-Desktop"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">卸载 Docker Desktop</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#macOS"><span class="toc-number">2.1.4.</span> <span class="toc-text">macOS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Docker-Desktop-1"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">卸载 Docker Desktop</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">2.1.5.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-%E6%9B%B4%E6%96%B0%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC"><span class="toc-number">2.2.</span> <span class="toc-text">安装/更新最新版本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E5%91%BD%E4%BB%A4"><span class="toc-number">3.</span> <span class="toc-text">Docker命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E5%AD%98%E5%82%A8"><span class="toc-number">4.</span> <span class="toc-text">Docker存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E6%8C%82%E8%BD%BD"><span class="toc-number">4.1.</span> <span class="toc-text">目录挂载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E6%98%A0%E5%B0%84"><span class="toc-number">4.2.</span> <span class="toc-text">卷映射</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E7%BD%91%E7%BB%9C"><span class="toc-number">5.</span> <span class="toc-text">Docker网络</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E7%BB%83%E4%B9%A0"><span class="toc-number">6.</span> <span class="toc-text">实战练习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E9%9B%86%E7%BE%A4"><span class="toc-number">6.1.</span> <span class="toc-text">Redis主从同步集群</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8MySQL"><span class="toc-number">6.2.</span> <span class="toc-text">启动MySQL</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-compose"><span class="toc-number">7.</span> <span class="toc-text">Docker compose</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">7.1.</span> <span class="toc-text">常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-up"><span class="toc-number">7.1.1.</span> <span class="toc-text">docker-compose up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-down"><span class="toc-number">7.1.2.</span> <span class="toc-text">docker-compose down</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-ps"><span class="toc-number">7.1.3.</span> <span class="toc-text">docker-compose ps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-logs"><span class="toc-number">7.1.4.</span> <span class="toc-text">docker-compose logs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-build"><span class="toc-number">7.1.5.</span> <span class="toc-text">docker-compose build</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-exec"><span class="toc-number">7.1.6.</span> <span class="toc-text">docker-compose exec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-start"><span class="toc-number">7.1.7.</span> <span class="toc-text">docker-compose start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-stop"><span class="toc-number">7.1.8.</span> <span class="toc-text">docker-compose stop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-restart"><span class="toc-number">7.1.9.</span> <span class="toc-text">docker-compose restart</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-pull"><span class="toc-number">7.1.10.</span> <span class="toc-text">docker-compose pull</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-config"><span class="toc-number">7.1.11.</span> <span class="toc-text">docker-compose config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-run"><span class="toc-number">7.1.12.</span> <span class="toc-text">docker-compose run</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-scale"><span class="toc-number">7.1.13.</span> <span class="toc-text">docker-compose scale</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-port"><span class="toc-number">7.1.14.</span> <span class="toc-text">docker-compose port</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-top"><span class="toc-number">7.1.15.</span> <span class="toc-text">docker-compose top</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">7.1.16.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Docker-compose%E5%90%AF%E5%8A%A8wordpress"><span class="toc-number">7.2.</span> <span class="toc-text">使用Docker compose启动wordpress</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#restart-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">7.2.1.</span> <span class="toc-text">--restart 的作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#compose-yaml"><span class="toc-number">7.3.</span> <span class="toc-text">compose.yaml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%80%A7"><span class="toc-number">7.4.</span> <span class="toc-text">特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E9%87%8F%E6%9B%B4%E6%96%B0"><span class="toc-number">7.4.1.</span> <span class="toc-text">增量更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%8D%E5%88%A0"><span class="toc-number">7.4.2.</span> <span class="toc-text">数据不删</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dockerfile"><span class="toc-number">8.</span> <span class="toc-text">Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87Dockerfile%E6%9E%84%E5%BB%BA-%E9%95%9C%E5%83%8F"><span class="toc-number">8.1.</span> <span class="toc-text">通过Dockerfile构建 镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%88%86%E5%B1%82%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">8.2.</span> <span class="toc-text">镜像分层存储机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B1%82%E5%AD%98%E5%82%A8%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">8.2.1.</span> <span class="toc-text">分层存储的概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B1%82%E5%AD%98%E5%82%A8%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">8.2.2.</span> <span class="toc-text">分层存储的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%B1%82"><span class="toc-number">8.2.2.1.</span> <span class="toc-text">镜像层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E5%B1%82"><span class="toc-number">8.2.2.2.</span> <span class="toc-text">容器层</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B1%82%E5%AD%98%E5%82%A8%E7%9A%84%E7%A4%BA%E4%BE%8B"><span class="toc-number">8.2.3.</span> <span class="toc-text">分层存储的示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E5%BD%95%EF%BC%9A%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E8%B6%85%E5%A4%9A%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">9.</span> <span class="toc-text">附录：一键安装超多中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml"><span class="toc-number">9.1.</span> <span class="toc-text">yaml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8"><span class="toc-number">9.2.</span> <span class="toc-text">启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE"><span class="toc-number">9.3.</span> <span class="toc-text">访问</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/18/59743779c169/" title="【白嫖福利】注册US.KG免费域名"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/12/18/6762e71b2e658.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【白嫖福利】注册US.KG免费域名"></a><div class="content"><a class="title" href="/2024/12/18/59743779c169/" title="【白嫖福利】注册US.KG免费域名">【白嫖福利】注册US.KG免费域名</a><time datetime="2024-12-18T14:53:30.000Z" title="发表于 2024-12-18 22:53:30">2024-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/16/d5e9d59f93d4/" title="博客、论坛必备：一键填充评论区昵称、邮箱、网址"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/12/16/675fdff3aa4bb.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客、论坛必备：一键填充评论区昵称、邮箱、网址"></a><div class="content"><a class="title" href="/2024/12/16/d5e9d59f93d4/" title="博客、论坛必备：一键填充评论区昵称、邮箱、网址">博客、论坛必备：一键填充评论区昵称、邮箱、网址</a><time datetime="2024-12-16T06:35:35.000Z" title="发表于 2024-12-16 14:35:35">2024-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/15/a9c615a71d17/" title="【智能协同云图库】3-用户模块"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/12/09/6756ee980378a.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【智能协同云图库】3-用户模块"></a><div class="content"><a class="title" href="/2024/12/15/a9c615a71d17/" title="【智能协同云图库】3-用户模块">【智能协同云图库】3-用户模块</a><time datetime="2024-12-15T03:12:06.000Z" title="发表于 2024-12-15 11:12:06">2024-12-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/13/2ec3ab3954b3/" title="通过SSH密钥连接Linux"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/12/13/675c5996649aa.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="通过SSH密钥连接Linux"></a><div class="content"><a class="title" href="/2024/12/13/2ec3ab3954b3/" title="通过SSH密钥连接Linux">通过SSH密钥连接Linux</a><time datetime="2024-12-13T15:37:00.000Z" title="发表于 2024-12-13 23:37:00">2024-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/13/0616411766f4/" title="【Hexo】一键部署至远程服务器"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/i/2024/12/13/675c59eff34f4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Hexo】一键部署至远程服务器"></a><div class="content"><a class="title" href="/2024/12/13/0616411766f4/" title="【Hexo】一键部署至远程服务器">【Hexo】一键部署至远程服务器</a><time datetime="2024-12-13T13:35:49.000Z" title="发表于 2024-12-13 21:35:49">2024-12-13</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/shiguang-coding" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" href="mailto:an_shiguang@163.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" size="50px"><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html">开往</a><a class="footer-item" title="异次元之旅" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on">异次元之旅</a><a class="footer-item" title="列表导航" target="_blank" rel="noopener" href="https://zhblogs.ohyee.cc/">列表导航</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a></div></div><div class="footer-group"><div class="footer-title">文章</div><div class="footer-links"><a class="footer-item" title="归档" href="/archives/">归档</a><a class="footer-item" title="分类" href="/categories/">分类</a><a class="footer-item" title="标签" href="/tags/">标签</a><a class="footer-item" title="RSS" href="/tom.xml">RSS</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="留言板" href="/comment/">留言板</a><a class="footer-item" title="关于我" href="/about/">关于我</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"></a><a class="github-badge" target="_blank" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=blog.shiguangdev.cn" style="margin-inline:5px" data-title="萌ICP备20246006号" title="萌ICP备20246006号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shields.io/badge/%E8%90%8Cicp%E5%A4%87-20246006%E5%8F%B7-FF1485" alt="萌ICP备20246006号"></a><a class="github-badge" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">©2023 - 2024 By <a class="footer-bar-link" href="/" title="時光" target="_blank">時光</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://img.shiguangdev.cn/" title="图床">图床</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="豫ICP备2024070732号">豫ICP备2024070732号</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">257</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">188</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">16</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://publish.shiguang666.eu.org/" title="地址发布页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="地址发布页"><span class="back-menu-item-text">地址发布页</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.shiguang666.eu.org" title="時光主页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="時光主页"><span class="back-menu-item-text">時光主页</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://nav.shiguang666.eu.org" title="時光导航站"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://nav.shiguang666.eu.org/images/logo-collapsed@2x.png" alt="時光导航站"><span class="back-menu-item-text">時光导航站</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://lobe.shiguang666.eu.org" title="LobeChat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lobe.shiguang666.eu.org/favicon.ico" alt="LobeChat"><span class="back-menu-item-text">LobeChat</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://chatgpt.shiguang666.eu.org/" title="NextChat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chatgpt.shiguang666.eu.org/favicon.ico" alt="NextChat"><span class="back-menu-item-text">NextChat</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://geminichat.shiguang666.eu.org/" title="GeminiChat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://geminichat.shiguang666.eu.org/icons/logo-512x512.png" alt="GeminiChat"><span class="back-menu-item-text">GeminiChat</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://game.shiguang666.eu.org" title="怀旧游戏机"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="怀旧游戏机"><span class="back-menu-item-text">怀旧游戏机</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://love.shiguang666.eu.org" title="表白生成器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://love.shiguang666.eu.org/favicon.ico" alt="表白生成器"><span class="back-menu-item-text">表白生成器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">后台管理</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://umami.shiguangdev.cn/share/1CY8KW6pqM0UBUIL/blog.shiguangdev.cn" title="访客统计"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://umami.shiguangdev.cn/favicon.ico" alt="访客统计"><span class="back-menu-item-text">访客统计</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://img.shiguangdev.cn/" title="時光图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shiguangdev.cn/favicon.ico" alt="時光图床"><span class="back-menu-item-text">時光图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://qexo.shiguang666.eu.org/" title="Qexo"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png" alt="Qexo"><span class="back-menu-item-text">Qexo</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随机</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/news/"><i class="fa fa-calendar faa-tada"></i><span> 早报亭</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=10051718332&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/gallery/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/xjj/"><i class="fa fa-rocket faa-tada"></i><span> 养生堂</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comment/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>9</sup></a><a href="/tags/Alist/" style="font-size: 0.88rem;">Alist<sup>3</sup></a><a href="/tags/CentOS/" style="font-size: 0.88rem;">CentOS<sup>1</sup></a><a href="/tags/ChatGPT/" style="font-size: 0.88rem;">ChatGPT<sup>13</sup></a><a href="/tags/ChatGPt/" style="font-size: 0.88rem;">ChatGPt<sup>1</sup></a><a href="/tags/Chrome/" style="font-size: 0.88rem;">Chrome<sup>1</sup></a><a href="/tags/CloudFlare/" style="font-size: 0.88rem;">CloudFlare<sup>3</sup></a><a href="/tags/DNS/" style="font-size: 0.88rem;">DNS<sup>1</sup></a><a href="/tags/Ecology/" style="font-size: 0.88rem;">Ecology<sup>1</sup></a><a href="/tags/GPT-4o/" style="font-size: 0.88rem;">GPT-4o<sup>2</sup></a><a href="/tags/Gemini/" style="font-size: 0.88rem;">Gemini<sup>2</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>8</sup></a><a href="/tags/GitHub/" style="font-size: 0.88rem;">GitHub<sup>6</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>24</sup></a><a href="/tags/IDEA/" style="font-size: 0.88rem;">IDEA<sup>3</sup></a><a href="/tags/KeyBoardTestUtility/" style="font-size: 0.88rem;">KeyBoardTestUtility<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>4</sup></a><a href="/tags/Lombok/" style="font-size: 0.88rem;">Lombok<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 0.88rem;">Markdown<sup>2</sup></a><a href="/tags/MindManager/" style="font-size: 0.88rem;">MindManager<sup>1</sup></a><a href="/tags/Mysql/" style="font-size: 0.88rem;">Mysql<sup>2</sup></a><a href="/tags/Perplexity-AI/" style="font-size: 0.88rem;">Perplexity AI<sup>1</sup></a><a href="/tags/PicGo/" style="font-size: 0.88rem;">PicGo<sup>1</sup></a><a href="/tags/QQ/" style="font-size: 0.88rem;">QQ<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 0.88rem;">SQL<sup>12</sup></a><a href="/tags/SSL/" style="font-size: 0.88rem;">SSL<sup>3</sup></a><a href="/tags/Sqlserver/" style="font-size: 0.88rem;">Sqlserver<sup>1</sup></a><a href="/tags/Typora/" style="font-size: 0.88rem;">Typora<sup>5</sup></a><a href="/tags/drawio/" style="font-size: 0.88rem;">drawio<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/mysql/" style="font-size: 0.88rem;">mysql<sup>1</sup></a><a href="/tags/svn/" style="font-size: 0.88rem;">svn<sup>2</sup></a><a href="/tags/%E5%9B%BE%E5%90%A7%E5%B7%A5%E5%85%B7%E7%AE%B1/" style="font-size: 0.88rem;">图吧工具箱<sup>1</sup></a><a href="/tags/%E5%9B%BE%E5%BA%8A/" style="font-size: 0.88rem;">图床<sup>7</sup></a><a href="/tags/%E5%BC%80%E6%BA%90%E5%88%86%E4%BA%AB/" style="font-size: 0.88rem;">开源分享<sup>6</sup></a><a href="/tags/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" style="font-size: 0.88rem;">搜索引擎<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E6%81%A2%E5%A4%8D/" style="font-size: 0.88rem;">数据恢复<sup>1</sup></a><a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 0.88rem;">模板<sup>4</sup></a><a href="/tags/%E8%B8%A9%E5%9D%91/" style="font-size: 0.88rem;">踩坑<sup>6</sup></a><a href="/tags/%E9%B1%BC%E7%9A%AE/" style="font-size: 0.88rem;">鱼皮<sup>11</sup></a></div></div><hr></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="10051718332" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/my/m/music/playlist?id=10051718332&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async="" src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("05/01/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 時光 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async="" src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.shiguangdev.eu.org',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.shiguangdev.eu.org',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async="" src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.shiguangdev.eu.org',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async="" data-pjax="" src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="/js/custom/footer-animal.js" defer=""></script><script src="/api/card-welcome.js"></script><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><!-- hexo injector body_end start -->
  <script data-pjax="" src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax="">
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://githubcalendarapi.shiguang666.eu.org/api?user=shiguang-coding";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="shiguang-coding";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end -->
    <link rel="stylesheet" href="https://ai.tianli0.top/static/public/postChatUser_summary.min.css">
    <script>
        let tianliGPT_key = '75439fb77e5551eacf54f0df75565616dcf2ad';
        let tianliGPT_postSelector = '#article-container';
        let tianliGPT_Title = '文章摘要';
        let tianliGPT_postURL = '/^https?://[^/]+/[0-9]{4}/[0-9]{2}/[0-9]{2}/';
        let tianliGPT_blacklist = '';
        let tianliGPT_wordLimit = '1000';
        let tianliGPT_typingAnimate = true;
        var postChatConfig = {
          backgroundColor: "#3e86f6",
          bottom: "16px",
          left: "16px",
          fill: "#FFFFFF",
          width: "44px",
          frameWidth: "375px",
          frameHeight: "600px",
          defaultInput: true,
          upLoadWeb: true,
          showInviteLink: true,
          userTitle: "PostChat",
          userDesc: "如果你对网站的内容有任何疑问，可以来问我哦～",
          addButton: true,
          beginningText: "这篇文章介绍了"
        };
    </script>
    <script data-postchat_key="75439fb77e5551eacf54f0df75565616dcf2ad" src="https://ai.tianli0.top/static/public/postChatUser_summary.min.js"></script>
  </body></html>